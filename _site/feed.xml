<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>LawooTrip</title>
    <description>龟龟的个人博客-乐物旅行</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Wed, 26 Sep 2018 08:22:55 +0000</pubDate>
    <lastBuildDate>Wed, 26 Sep 2018 08:22:55 +0000</lastBuildDate>
    <generator>Jekyll v3.6.2</generator>
    
      <item>
        <title>走马换将-大决战中的国军主帅-全10集</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;Vue.js 放弃中…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;走马换将-大决战中的国军主帅-全10集&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/1-%E6%90%AD%E6%A1%A3-videoplayback.MP4&quot;&gt;第1集——搭档&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/2-%E8%A2%AB%E8%A7%A3%E8%81%8C%E7%9A%84%E5%90%8D%E5%B0%86-videoplayback.MP4&quot;&gt;第2集——被解职的将军&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/3-%E6%80%BB%E9%95%BF%E6%8C%82%E5%B8%85-videoplayback.MP4&quot;&gt;第3集——总长挂帅&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/4-%E6%8A%97%E5%91%BD-videoplayback.MP4&quot;&gt;第4集——抗命&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/5-%E4%BA%B2%E5%BE%81-videoplayback.MP4&quot;&gt;第5集——亲征&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/6-%E9%9D%9E%E5%AB%A1%E7%B3%BB-videoplayback.MP4&quot;&gt;第6集——非嫡系&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/7-%E8%83%9C%E8%B4%A5%E4%B9%8B%E9%97%B4-videoplayback.MP4&quot;&gt;第7集——胜败之间&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/8-%E6%89%8D%E8%83%BD%E4%B8%8E%E5%BF%A0%E8%AF%9A-videoplayback.MP4&quot;&gt;第8集——才能与忠诚&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/9-%E6%8A%98%E5%86%B2-videoplayback.MP4&quot;&gt;第9集——折冲&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://image.lawootrip.com/10-%E4%B8%8B%E9%87%8E-videoplayback.MP4&quot;&gt;第10集——下野&lt;/a&gt;&lt;/p&gt;

&lt;!-- &lt;iframe 
    width=&quot;800&quot; 
    height=&quot;450&quot;
    src=&quot;http://image.lawootrip.com/2-%E8%A2%AB%E8%A7%A3%E8%81%8C%E7%9A%84%E5%90%8D%E5%B0%86-videoplayback.MP4&quot;
    frameborder=&quot;0&quot; 
    allowfullscreen&gt;
&lt;/iframe&gt; --&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/0%20%2837%29.gif&quot; /&gt; &lt;/td&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/1490924677.png&quot; /&gt;&lt;div&gt;&lt;small class=&quot;img-hint&quot;&gt;这不是收钱的  加个好友而已&lt;/small&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</description>
        <pubDate>Wed, 26 Sep 2018 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2018/09/26/Civil-war-Phoenix/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/09/26/Civil-war-Phoenix/</guid>
        
        <category>国共内战</category>
        
        <category>视频</category>
        
        
      </item>
    
      <item>
        <title>Mac-Mysql8.0-Yii2的一点小坑</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;Vue.js 放弃中…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;在Mac Sierra 10.13.6部署Yii2+Mysql8.0+Nginx，遇到几个小坑，备忘如下：&lt;/p&gt;

&lt;h3 id=&quot;1-mysql报错the-server-quit-without-updating-pid-file&quot;&gt;1. Mysql报错：&lt;code class=&quot;highlighter-rouge&quot;&gt;The server quit without updating PID file&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;一把梭：完全卸载Mysql，并用brew install mysql重新安装;&lt;/p&gt;

&lt;h2 id=&quot;卸载&quot;&gt;卸载&lt;/h2&gt;

&lt;p&gt;依次执行：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    brew uninstall mysql 

    sudo rm /usr/local/var/mysql 

    sudo rm -rf /usr/local/mysql* 

    sudo rm -rf /Library/LaunchDaemons/com.oracle 

    brew cleanup 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;===我只用了上面这五行====&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    sudo rm -rf /Library/StartupItems/MySQLCOM 

    sudo rm -rf /Library/PreferencePanes/My* 

    rm -rf ~/Library/PreferencePanes/My* 

    sudo rm -rf /Library/Receipts/mysql* 

    sudo rm -rf /Library/LaunchDaemons/com.oracle 

    sudo rm -rf /var/db/receipts/com.mysql.* 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;其实不同的安装方式有些东西的存储位置不一样，删除完检查一下下面这些文件是否删除了，没有的话则删除掉：&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/Cellar&lt;/code&gt; 里的mysql文件&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/var&lt;/code&gt; 里的mysql文件&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp&lt;/code&gt; 里的mysql.sock, mysql.sock.lock, my.cnf文件&lt;/p&gt;

&lt;p&gt;pid文件和err文件都在&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/var/mysql&lt;/code&gt;里确保删除了&lt;/p&gt;

&lt;p&gt;brew安装的安装包存储在&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/Library/Cache/Homebrew&lt;/code&gt;也可以一并删除&lt;/p&gt;

&lt;p&gt;执行&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    brew cleanup
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;安装&quot;&gt;安装&lt;/h2&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    brew install mysql
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;执行&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    mysql.server start
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;如果报错，99%的可能是老版本的mysql没有卸载干净，重新检查卸载流程；&lt;/p&gt;

&lt;p&gt;接下来执行配置脚本&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    /usr/local/opt/mysql/bin/mysql_secure_installation //mysql 提供的配置向导
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;安装成功&lt;/p&gt;

&lt;h3 id=&quot;2-yii2报错sqlstatehy000-2054-the-server-requested-authentication-method-unknown-to-the-client&quot;&gt;2. Yii2报错：&lt;code class=&quot;highlighter-rouge&quot;&gt;SQLSTATE[HY000] [2054] The server requested authentication method unknown to the client&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;发生这种错误，是由于MySQL 8默认使用了新的密码验证插件：caching_sha2_password，而之前的PHP版本中所带的mysqlnd无法支持这种验证。解决这个问题，有两种办法。&lt;/p&gt;

&lt;p&gt;一种办法是升级PHP支持MySQL 8的新验证插件。&lt;/p&gt;

&lt;p&gt;PHP 7.2.8和PHP 7.1.20已经可以支持caching_sha2_password，直接连接MySQL 8。&lt;/p&gt;

&lt;p&gt;目前PHP 7.0.31和PHP 5.6.37还无法支持caching_sha2_password，不知道后续版本是否会做出支持。&lt;/p&gt;

&lt;p&gt;可以通过phpinfo()函数了解当前安装的PHP是否支持caching_sha2_password：&lt;/p&gt;

&lt;p&gt;如果不能升级PHP，可以在MySQL 8中创建（或修改）使用caching_sha2_password插件的账户，使之使用mysql_native_password，这样先前版本的PHP就可以连接使用了。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;在CREATE USER时，使用IDENTIFIED WITH xxx_plugin BY ‘password’，比如：&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; CREATE USER 'native'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password!2#4';
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;使用ALTER USER修改已有账户的验证插件：&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; ALTER USER 'native'@'localhost' IDENTIFIED WITH mysql_native_password
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;或&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    ALTER USER 'native'@'localhost' IDENTIFIED WITH mysql_native_password BY '123123';
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;采用前一种方式，账户的密码将被清除；&lt;code class=&quot;highlighter-rouge&quot;&gt;123123&lt;/code&gt;将为账户设置的新密码。&lt;/p&gt;

&lt;p&gt;/etc/my.cnf配置文件中，有一行：&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;# default-authentication-plugin=mysql_native_password&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;请删除注释符号“#”并重新启动mysqld使之生效，此后创建的账户均默认使用mysql_native_password。&lt;/p&gt;

&lt;p&gt;如果完成MySQL Server的安装之后，在没有启动过mysqld服务的情况下修改/etc/my.cnf配置，那么启动mysqld之后创建的’root’@’localhost’账户也是使用mysql_native_password插件的。&lt;/p&gt;

&lt;h3 id=&quot;3-yii2报错sqlstate42000-syntax-error-or-access-violation-1055-expression&quot;&gt;3. Yii2报错&lt;code class=&quot;highlighter-rouge&quot;&gt;SQLSTATE[42000]: Syntax error or access violation: 1055 Expression&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://cloud.githubusercontent.com/assets/1667825/15820229/6b9a7286-2be8-11e6-90a7-bf31332dddcf.png&quot; alt=&quot;&quot; /&gt;&lt;small class=&quot;img-hint&quot;&gt;分组问题报错&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;这个就非常简单了&lt;/p&gt;

&lt;p&gt;在Mysql的配置文件my.cnf设置中，添加：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    sql_mode=TRADITIONAL
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;http://dev.mysql.com/doc/refman/5.7/en/sql-mode.html&quot;&gt;参考资料&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/0%20%2837%29.gif&quot; /&gt; &lt;/td&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/1490924677.png&quot; /&gt;&lt;div&gt;&lt;small class=&quot;img-hint&quot;&gt;这不是收钱的  加个好友而已&lt;/small&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</description>
        <pubDate>Mon, 17 Sep 2018 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2018/09/17/mysql-Yii-mac/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/09/17/mysql-Yii-mac/</guid>
        
        <category>Mysql</category>
        
        <category>Yii2</category>
        
        <category>Mac</category>
        
        <category>环境配置</category>
        
        
      </item>
    
      <item>
        <title>《足球往事》</title>
        <description>&lt;h2 id=&quot;作者自白&quot;&gt;作者自白&lt;/h2&gt;

&lt;p&gt;像所有的乌拉圭孩子一样，我也曾想成为一名足球运动员。我的球踢得不错，事实上是非常棒，不过那只是在晚上，当我睡着了的时候。到了白天，我在球场上就像根木桩一样，成为家乡踢过球的小孩中最愚钝的一个。&lt;/p&gt;

&lt;p&gt;当球迷我也有很多有待改进的地方，作为乌拉圭民族队的忠实球迷，我对在同城死敌佩那罗尔队效力的胡安·阿尔贝托·斯基亚菲诺和胡利奥·阿巴迪的厌恶无以复加。但是当“胡椒”斯基亚菲诺好似从球场最高的塔上俯瞰比赛，用他那娴熟的传球指挥着球队的表演时，当“褐色”阿巴迪蹬着他的“百里靴”风驰电掣般带球，一路狂奔越过球门线，在球和对手中间身姿摇曳、毫发无伤时，我也禁不住对他们钦佩不已，甚至为他们击节叫好。&lt;/p&gt;

&lt;p&gt;时光流逝，我最终学会了接受自己是个什么样的人：我是一个精彩足球的乞讨者。我行走在人世间，双臂张开，在球场中向上天乞求：给我一个漂亮的足球动作吧，看在上帝的分上！&lt;/p&gt;

&lt;p&gt;当精彩足球真的发生时，我对奇迹充满感激，而不管是哪支球队、哪个国家表演了这美丽的足球，我都毫不计较。&lt;/p&gt;

&lt;h2 id=&quot;足球&quot;&gt;足球&lt;/h2&gt;

&lt;p&gt;足球的历史是一段从美丽走向职责的伤感历程。当这项运动变为一项产业，绽放在玩耍乐趣之上的足球美丽之花便被连根拔起。在这个处于“世纪末”的世界，职业足球将所有非盈利的行为斥为无用。玩乐的疯狂感觉能够将踢球的大人瞬间变成正在玩耍气球的小孩，如同一只正在玩弄毛线球的小猫；这种疯狂也能够使他变成一位围绕着足球欢快跳跃的芭蕾舞者，那足球也仿佛变得像气球和毛线球一般轻盈，他尽情嬉戏而浑然不觉自己是在踢球，没有动机，没有裁判，忘却了时间。但是这种疯狂玩乐的感觉却无法帮你赚取任何金钱。&lt;/p&gt;

&lt;p&gt;玩耍变成了由少量主角表演、众多旁观者观赏的演出，随后这场演出变成了世界上最有利可图的生意，这笔生意并非为玩耍而设，而是妨碍了玩耍。职业运动的技术控制管理给足球注入了闪电般的速度和粗野的力量，却否定了踢球的乐趣，谋杀了球员的奇思妙想，泯灭了他们的冒险精神。&lt;/p&gt;

&lt;p&gt;幸运的是，在足球场上你仍可以看到，即使很久才有那么一次：一些无礼的淘气鬼打破常规，在裁判和看台上的拥挤人群面前，冒带球之大不韪过掉对方的整个球队，所有这些都是为了享受被禁闭的自由而进行的一场冒险，并从中获得身体上的愉悦。&lt;/p&gt;

&lt;h2 id=&quot;球迷&quot;&gt;球迷&lt;/h2&gt;

&lt;p&gt;每周一次，球迷都从家中逃离，涌向球场。&lt;/p&gt;

&lt;p&gt;球场里横幅挥舞，旌旗飘飘，人声鼎沸，空中回响着炮声和鼓声，彩屑漫天好似雨花从天而降。城市中万人空巷，工作停顿，球场这座神庙就是一切的存在。在这个神圣的地方，世界上唯一没有反对者的宗教将展示出他的神灵们。虽然球迷可以通过电视更舒适地注视这个神迹，但是他宁愿到现场去完成他的朝圣之旅，在那里来观看他鲜活饱满的天使同当日的恶魔之间的战斗。&lt;/p&gt;

&lt;p&gt;在这里球迷挥舞着他的围巾，咽着唾沫，咬着帽檐，轻声祈祷，小声咒骂，提心吊胆，然后突然爆发出一阵欢呼，像跳蚤般跃起去拥抱旁边的陌生人，以此来庆祝进球。当这异教的弥撒持续进行，球迷也变得数量众多。他与成千上万的其他信徒一起分享“自己信奉的球队最棒”的信念，认为所有的裁判都是卑鄙小人，所有对手都是骗子无赖。&lt;/p&gt;

&lt;p&gt;球迷们很少说：“我的球队今天比赛。”而是说：“我们今天比赛。”他知道他是球队的第12人，当比赛昏昏欲睡，他要煽动激情的旋风推动比赛，正如其他11名球员所知，踢球时若是没有球迷就像跳舞没有音乐一样枯燥乏味。&lt;/p&gt;

&lt;p&gt;当比赛结束，球迷依然欢庆着他的胜利，不愿离场：“我们今天打进了一个多么漂亮的球。”“我们把他们打得落花流水。”或者，他也会为自己的失败呐喊：“他们今天又一次骗走了胜利。”“裁判你这个小偷。”随后太阳渐渐西下，球迷也逐渐散去，阴影开始笼罩正在变得空旷的球场。在水泥的阶梯看台上，有几处篝火燃烧，不一会火光便消失无迹，再无声息，球场终于只剩孤寂，而球迷也同样回归孤独：在球场外，“我们”重又变成了“我”。球迷散尽，人群稀落消释，球赛过后的周日变得如同狂欢节后的圣灰星期三一般愁云惨淡。&lt;/p&gt;

&lt;h2 id=&quot;足球狂&quot;&gt;足球狂&lt;/h2&gt;

&lt;p&gt;足球狂是一个应该待在疯人院的球迷。他的狂热使他拒绝一切证据，这狂热最终颠覆了他头脑中任何曾经闪过的念想，思想沉船的遗骸在水中漫无目的地旋转，还要受到他盛怒之下毫不留情的鞭挞。&lt;/p&gt;

&lt;p&gt;足球狂裹着队旗出现在球场，脸上涂着痴迷的球队球衫的颜色，他精神亢奋，随身携带着可以发出刺耳声音的、带有挑衅意味的小玩意，一路上高声喧哗、鼓噪不安。他从不单独行动，在喧闹的人群中，他就像条危险的蜈蚣，这个平日胆小懦弱、担惊受怕的家伙，此时却会威胁恐吓别人，令人恐惧。星期天无所不能的力量驱走了他一周唯唯诺诺的生活：在床上他没有任何欲望，工作中他没有任何责任感，或者干脆就没有工作。现在可以无拘无束地过一整天，足球狂有太多的东西想要宣泄。&lt;/p&gt;

&lt;p&gt;仿佛癫痫发作，他盯着球场却看不进比赛。他的竞技场是看台，那是他的战场。仅仅是对方球迷的出现就已经构成了不可饶恕的挑衅。正义并非生来就崇尚暴力，但是邪恶让它别无选择。敌人永远是错的，应当受到一顿痛打。足球狂注意力高度集中，因为敌人无处不在，甚至在安静的旁观者中，任何时刻如果有人认为对手踢得很公平，那么就会被他一顿饱揍。&lt;/p&gt;

&lt;h2 id=&quot;裁判&quot;&gt;裁判&lt;/h2&gt;

&lt;p&gt;在西班牙语里他叫仲裁者，并且总是独断专行，他是一位全知全能的暴君，毫无阻碍地进行着自己的专制统治；他是一位自命不凡的行刑者，用夸张的戏剧动作行使着他的绝对权力。他唇间的一声口哨，就能刮起一阵不可逆转的命运风暴，要么承认进球，要么进球无效。他举起手中的红黄牌，那是厄运的颜色：黄色用以惩戒罪人，命其忏悔；红色则将其放逐流亡。&lt;/p&gt;

&lt;p&gt;巡边员在场地两边观战，只可协助而不可裁决。只有裁判才能踏入比赛场地，当他出现在山呼海啸的人群面前时，他绝对有理由在胸前画十字祷告上帝。他的工作就是让自己遭人憎恨，足球世界中唯一普遍的观点是：每个人都恨裁判。他得到的永远是嘘声而不是掌声。&lt;/p&gt;

&lt;p&gt;没有人比他跑得更多，整场比赛他必须一刻不停地奔跑，这位球赛的不速之客像马一般飞驰，弓着腰在每位球员的耳边喘着粗气。他的痛苦得到的回报，却是人们劈头盖脸的怒吼。从始至终他挥汗如雨，强迫自己追逐那只在每位球员脚间来回跳跃的白色皮球。当然，他本也是热爱踢球的，但是被赋予如此特权后他便热爱不起来了。当他不巧碰到皮球时，整个球场便响起一片的咒骂声。即使如此，只要可以处在这足球轻盈逸动的绿色的神圣之所，他愿意忍受羞辱、嘘声、诅咒和石子。&lt;/p&gt;

&lt;p&gt;有时，不过这很少发生，他的判罚碰巧和球迷们的倾向一致，就算这样也并不意味着他会安然无恙。失败的一方会将失利归咎于他；赢球的欢呼庆祝，对他不管不顾。作为每一个过错的替罪羊、每一次不幸的肇事者，如果他本不存在，那么球迷们也会发明一个裁判出来。他们对他恨得越深，也就越离他不开。&lt;/p&gt;

&lt;p&gt;一个多世纪以来裁判都是一袭黑衣，像是为某人哀悼。为谁？为他自己吧。如今他身着亮丽色彩的衣服，得以掩饰自己的悲伤之感&lt;/p&gt;

&lt;h2 id=&quot;专家们&quot;&gt;专家们&lt;/h2&gt;

&lt;p&gt;比赛之前，记者们会提出他们的扰人的问题：“你准备好赢球了吗？”&lt;/p&gt;

&lt;p&gt;然后他们得到了一个惊人的回答：“我们将竭尽所能去夺取胜利。”&lt;/p&gt;

&lt;p&gt;随后，广播播音员起立发言，电视节目主持人则继续保持公司形象，他们知道广播无法同电视竞争，另一方面，广播评论员是比较无所畏惧的一类人。这些悬念大师的运动比球员的跑动还多，也比足球的滑动更多，他们以令人头晕目眩的速度描述的比赛，与你正在观看的并不一致。在他们口若悬河的语句中，你看到的一脚划破天际的射门居然变成了擦着横梁飞出；守门员打着哈欠，蜘蛛都可以在门柱之间悠闲地织网变成了进球马上就要到来。&lt;/p&gt;

&lt;p&gt;当这个巨型雕像里的活力四射的一天结束，轮到评论家们开始讲话了，他们已经数次打断播音员告诉球员该怎么做，但是球员们不听，因为他们实在太忙了，忙着犯错。这些“WM”阵型的理论家反对着“MW”阵型的理论家，两者其实相同，不过是互相颠倒，他们操着一种混杂了科学学问、战争宣言和诗情画意的语言。他们说起话来总是使用复数形式，因为他们人还不少。&lt;/p&gt;

&lt;h2 id=&quot;足球博士们的语言&quot;&gt;足球博士们的语言&lt;/h2&gt;

&lt;p&gt;今天下午在团结必胜足球俱乐部的球场进行了一场比赛，让我们把观点总结一下，制定出一个关于比赛中出现的战术、技术和身体问题的最优化的方案，这个问题毫无疑问要求复杂细致的分析，不允许简化了事，也不允许弄得含糊不清、模棱两可，这在过去、现在和永远都有悖于我们为服务公众运动奉献终生的信念。&lt;/p&gt;

&lt;p&gt;逃避责任，把主队输球归因于队员们的拘束表现是很容易的，但是球员们每一次接球时表现出的不可否认的过分懒散绝不是正当理由，善解人意的女士们和先生们，如此普遍的懒散和由此而来的不公正批评绝不是正当理由。不，不，绝不。服从不是我们的风格，正如你们中那些跟随我们多年的人所知，不但在我们热爱的祖国，而且在国际，甚至是全世界的体育舞台，无论在哪里我们都被要求履行我们谦卑的职责。因此，作为我们的习惯，我们将发出每一个字的每一个音节：这支努力拼搏的球队所贯彻比赛策略的内在潜力未能获得成功的嘉奖，仅仅且完全是因为球队始终无能力充分地将更宏大的进攻预期导向敌方的球门。上个周日我们就已经说过，今天我们可以这样断言，高昂着我们的头颅，绝不后悔，因为我们一直就被称作直言不讳的人，我们将继续说出事实，不管它会伤害、打倒谁，也不管要付出多大代价。&lt;/p&gt;

&lt;h2 id=&quot;精心编织的战争&quot;&gt;精心编织的战争&lt;/h2&gt;

&lt;p&gt;足球是战争的仪式升华，简而言之，11名队员就是街区、城市或国家的利剑。这些没有武器和盔甲的勇士驱除人间的恶魔并重申世间的信仰：每一次的敌我对峙，代代相传的古老仇恨和友爱都在这里斗争。&lt;/p&gt;

&lt;p&gt;体育场像一座尖塔耸立、旗帜飘扬的城堡，球场四周同样有深而宽的护城河。场地中央，一条白线分割开争执双方的领地。在各自领地的尽头，伫立着为飞起的足球轰炸的球门。球门正前的区域被称作“禁区”。&lt;/p&gt;

&lt;p&gt;双方队长在中圈按照礼仪的要求交换队旗，握手致意。裁判一声哨响，足球，这另一呼哨带风的物体，动了起来。足球前后游走，一名球员俘获了她，带着她一路向前，直到他被铲倒在地、四肢摊开。受害者没有起来，他俯伏在这广袤的绿色中。有声音从巨大的看台传来，那是敌方人群发出的友善吼叫：&lt;/p&gt;

&lt;p&gt;“¡Que se muera！”（西班牙语：他死了！）&lt;/p&gt;

&lt;p&gt;“Devi morire！”（意大利语：去死吧！）&lt;/p&gt;

&lt;p&gt;“Tuez-le！”（法语：杀了他！）&lt;/p&gt;

&lt;p&gt;“Mach ihn nieder！”（德语：让他失望！）&lt;/p&gt;

&lt;p&gt;“Let him die！”（英语：让他去死吧！）&lt;/p&gt;

&lt;p&gt;“Kill kill kill！”（英语：杀！杀！杀！）&lt;/p&gt;

&lt;h2 id=&quot;战争的语言&quot;&gt;战争的语言&lt;/h2&gt;

&lt;p&gt;按照既定战略，有效地利用战术变化，我们的队伍快速冲锋，突然出现在毫无准备的敌人面前。这是一次野蛮的进攻。当我们的军队入侵敌人的领土时，破城槌在防护墙最脆弱的侧翼凿开了一个缺口，随后渗透到危险地带。炮兵收到了弹药，用熟练的动作到达射击位置，他拱起背准备发射，随着炮弹出膛，敌方的守卫被歼灭，这场进攻也到达了顶点。然后战败的卫兵、那位曾经看似坚不可摧的堡垒的守护者，双手捂脸，跪倒在地，而那位射杀他的刽子手则朝欢呼庆祝的人群高举着双臂。&lt;/p&gt;

&lt;p&gt;敌人并未撤退，但是他们的蜂拥而至没有在我们的战壕中散布恐慌，他们一次又一次冲击着我们全副武装的后卫，在我们那如雄狮般战斗的战士的英勇无畏面前，他们射出的弹药全都喑哑无效。当我们的两个战士在战斗中被撞倒，人们会徒劳地呼吁最严厉的判决，但是这种在高贵的足球运动的绅士规则中被视为无礼、而在战争中极为恰当的暴行仍会继续逍遥法外。&lt;/p&gt;

&lt;p&gt;最后，又聋又盲的裁判结束了整场比赛，一声适时的哨音释放了被打败的队伍。这时胜利的人们冲进堡垒，将他们的11个英雄高高举上肩头，是这些英雄为他们带来了这史诗般的壮举，这辉煌的成就，这令他们为之流汗、流泪、流血的伟大功绩。然后我们的队长，披着再也不会被失败所玷污的祖国的旗帜，举起银色的奖杯亲吻着，这是荣耀之吻！&lt;/p&gt;

&lt;h2 id=&quot;球场&quot;&gt;球场&lt;/h2&gt;

&lt;p&gt;你有没有进入过空荡荡的球场？如果没有的话去尝试一下吧。站在球场的中央侧耳倾听，没有比一座空空的球场更空旷虚无的了，也没有比失去了观众的看台更寂寥静谧的了。&lt;/p&gt;

&lt;p&gt;在温布利大球场，1966年世界杯英格兰胜利的呼喊仍在回响，如果你仔细倾听，你还能听见1953年英格兰败给匈牙利时的呻吟。蒙得维的亚的百年纪念球场怀念着乌拉圭足球曾经的荣耀，发出一声叹息。马拉卡纳球场仍然在为巴西在1950年世界杯上的失败哀号。在布宜诺斯艾利斯的糖果盒球场，半个世纪前的鼓声依然回荡。从阿兹特克球场深处，依稀传来古墨西哥足球游戏的仪式圣歌。巴塞罗那诺坎普球场的层层看台说着加泰罗尼亚语，而毕尔巴鄂的圣马梅斯球场讲的是巴斯克语。在米兰，朱塞佩·梅阿查灵魂附体的进球令这个刻有他名字的球场为之震动。1974年世界杯决赛，德国队在慕尼黑奥林匹克球场夜以继日地比赛，获得了胜利。沙特阿拉伯的法赫德国王球场的包厢镶金带玉，看台毛毯铺椅，却没有任何值得一提的回忆或事迹。&lt;/p&gt;

&lt;h2 id=&quot;球&quot;&gt;球&lt;/h2&gt;

&lt;p&gt;古代中国人踢的球是皮革做的，里面填充了麻布纤维。法老王时代的埃及人将稻草和籽壳用彩布包裹起来，做成了他们的足球。古希腊人和罗马人把牛的膀胱吹胀缝合后当球踢。中世纪和文艺复兴时期的欧洲人玩的球是椭圆形的，里面塞满了马鬃。在美洲，人们用橡胶做球，其弹性比其他球都要好，西班牙宫廷编年史里就记载了赫尔南·科尔蒂斯是怎样将一个墨西哥足球弹向高空，令查理五世惊讶地瞪圆了双眼的。&lt;/p&gt;

&lt;p&gt;19世纪中叶出现了橡胶气胆、皮革包覆的球，这要感谢来自美国康涅狄格州的查尔斯·古德伊尔的天才构想。此后过了很久，又多亏了三位来自科尔多瓦的阿根廷人托索里尼、瓦尔博内西和波罗的天才发明，无带足球诞生了。他们给球胆加了一个充气阀门取代了过去用来扎紧气口的气带，这样，自从1938年世界杯以后，球员头球时就不会因为气带而受伤了。&lt;/p&gt;

&lt;p&gt;在20世纪中叶以前，足球一直都是棕色的，然后，足球变成了白色。我们那个时代的足球则在白色的背景上饰有不同的黑色图案。现代足球最大直径为60厘米，重量不足0.5千克，老式的皮革足球在雨天环境下几乎就动不了，而新式足球穿上了聚氨酯聚乙烯泡沫材料做成的防水外衣，能够比皮革足球移动得更快。&lt;/p&gt;

&lt;p&gt;人们用各种名称来称呼足球：球体、圆球、玩意、皮球、飞球、飞弹。在巴西，足球毫无疑问是一位女性。巴西人把足球称作胖墩、肥妞，或者宝贝儿、姑娘，并会给她起一个类似于穆里尔、莱昂纳或玛格丽塔这样的女孩名字。&lt;/p&gt;

&lt;p&gt;当贝利在马拉卡纳体育场打进他的第1000个进球后，他深情地亲吻着她——足球。迪·斯蒂法诺在自己的房子前为她建了一座纪念碑，上面是一颗青铜制的足球，铭牌上写道：谢谢你，老姑娘。&lt;/p&gt;

&lt;p&gt;她忠贞，在1930年世界杯决赛中，对阵双方都坚持要求使用自己的足球。如所罗门王般明智的裁判决定上半场用阿根廷人的足球，下半场用乌拉圭人的。结果阿根廷赢了上半场，乌拉圭胜了下半场。她有时也会薄情寡义，在飞行途中改变主意，划着弧线远离球门，拒绝进球。你看，她就是这样容易生气。她不能忍受出于泄愤而被粗暴地对待或击打，只有爱抚、亲吻和哄骗才能够让她在球员的胸前或脚下安然入睡。她骄傲，可能还有一些自负，她从不缺乏理由：她清楚地知道当自己优雅地飞起时，她给人们的心灵带来愉悦，而当她狼狈地落地时，人们又为之心碎。&lt;/p&gt;

&lt;h2 id=&quot;起源&quot;&gt;起源&lt;/h2&gt;

&lt;p&gt;足球和几乎所有其他的事物一样，最早出现在中国。五千年前，中国魔术师使球在他们的脚上跳舞，不久之后他们组织了第一场球赛。球网在场地的中央，球员不能用手，不能让球落地。这项运动从一个朝代延续到下一个朝代，正如我们从一些公元前很久的浅浮雕纪念碑上看到的那样，一些明朝末年的雕刻也向我们展现出那时的人们玩弄一个简直是阿迪达斯制造的足球的情景。&lt;/p&gt;

&lt;p&gt;据我们所知，古代埃及人和古代日本人以踢球为乐。在公元前5世纪的希腊陵墓的大理石表面，雕刻着一个人用膝盖顶球的画面。安提法奈斯的喜剧中包含有诸如长球、短传、前传这样的表达……有人说恺撒大帝的双脚非常敏捷，而尼禄根本不会射门。不管怎么说，当耶稣被钉上十字架的时候，罗马人正在玩一种和足球相当近似的东西，这是毫无疑问的。&lt;/p&gt;

&lt;p&gt;罗马军团把球一直踢到了不列颠诸岛。几个世纪以后，1314年，爱德华二世颁布王室诏书斥责这项游戏是贫贱和暴力的：“鉴于市民为拥抢硕球而引发之巨大噪音，致邪魔顿起，故禁之以上帝之名。”当这项运动已经被叫做足球时，足球比赛是暴徒们的相互打斗，而且没有比赛人数、时间长度等限制，一场比赛后留下的，是大量的受害者。一整村的人同另一村的人比赛，他们拳打脚踢，冲向球门，而球门是个在远处的风车，比赛能扩展到方圆几里地，持续好些天，夺走好几条人命。国王们一再禁止这样的血腥事件：1349年，爱德华三世把足球列为“愚蠢和完全无用”的游戏，亨利四世和亨利六世分别在1410年和1447年签署了禁止足球的法令。但这一切仅仅证实了禁令不过是吊起了人们的胃口，因为你越取缔它，人们就越要玩它。&lt;/p&gt;

&lt;p&gt;1592年，莎士比亚在他写的《错误的喜剧》中运用足球来描述剧中角色的抱怨：“难道我就是个圆圆的皮球，给你们踢来踢去吗？／你把我一脚踢出去，他把我一脚踢回来／你们要我这皮球不破，还得替我补上一块厚厚的皮哩。”几年以后在《李尔王》中，肯特伯爵奚落道：“也不能被人踢吧，你这下贱的踢足球的！”&lt;/p&gt;

&lt;p&gt;在佛罗伦萨，足球以前被称作“卡尔奇奥”，现在在整个意大利仍这么叫。列奥纳多·达·芬奇是个狂热的球迷，马基雅维利也喜爱踢球。那时的足球每队有27个人，分成3组，允许手和脚触击皮球，甚至可以挖对手的肚子。人们成群结队参加在最大的广场或是亚诺河冰冻的河面上举行的这种比赛。在离佛罗伦萨很远的梵蒂冈的花园里，教皇克莱门特七世、利奥九世和乌尔班八世常常卷起他们的法衣去踢“卡尔奇奥”。&lt;/p&gt;

&lt;p&gt;早在公元前1500年，墨西哥和中美洲的神圣仪式中就用一个塞满东西的橡胶球祭祀太阳。但是我们不知道足球在众多的美洲地区是何时出现的。玻利维亚亚马孙地区的印第安人说他们从太古时代就一直踢球，那是一种在两根柱子之间踢的又大又重的橡胶球。18世纪，来自上巴拉那耶稣传教区的一名西班牙神甫描述了一种瓜拉尼人的古老习俗：“他们不像我们那样用手抛球，相反他们光着脚用脚面带球前进。”墨西哥和中美洲的印第安人一般用髋关节和前臂击球，尽管特奥蒂瓦坎和奇琴伊察的绘画画出的是他们用脚和膝盖踢球的情景。特旁蒂特拉里一幅一千多年前的壁画上画着一位乌戈·桑切斯的祖辈正用他的左脚娴熟地运球，当球接近终点时游戏也将结束：在穿越了死亡的领地之后，太阳于黎明时分到达，然后，鲜血洒出，旭日东升。据人所知，阿兹特克人有牺牲胜利者祭祀的习俗，断头之前，在他们身上涂以红色的条纹，上帝选择的供品将献出他的鲜血，大地将因此而丰饶，上天将因此而慷慨。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;［1］Guaranties，巴拉圭原住印第安人。&lt;br /&gt;［2］特奥蒂瓦坎（Teotihuacan），坐落在墨西哥波波卡特佩尔火山和依斯塔西瓦特尔火山山坡谷底之间，距墨西哥城40公里，是印第安文明的重要遗址；奇琴伊察（Chichen-Itza），古玛雅城市遗址，位于墨西哥尤卡坦州南部，是古玛雅文化和托尔特克文化的遗址。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;游戏规则&quot;&gt;游戏规则&lt;/h2&gt;

&lt;p&gt;经过多个世纪的官方取缔之后，不列颠诸岛最终接受了它们命中注定的足球。在维多利亚女皇时代，足球不仅作为一种平民习俗为人接受，而且作为一种贵族美德受到欢迎。&lt;/p&gt;

&lt;p&gt;社会的未来统治者们在大学校园里学习如何在足球比赛中战胜对手。在那里，上流社会的纨绔子弟挥洒青春的激情，磨炼他们的意志，学习忍耐，砥砺智慧。在社会的其他阶层，因有了工厂和车间的存在，工人们虽然不需用足球来检验自己身体的极限，但是这个工业资本主义的故乡的统治者们发现，足球，这个大众的宠儿，给穷人带来了愉悦和慰藉，使他们免生罢工或其他邪恶之念。&lt;/p&gt;

&lt;p&gt;1863年秋天在一个伦敦小酒馆里，12个英国俱乐部签署了一纸君子协定，现代足球形式由此诞生。这些俱乐部同意遵守1846年由剑桥大学制定的规则。在剑桥，足球和橄榄球分道扬镳：允许手触球，但是不准用手带球，严禁踢踹对手。“踢踹动作只能以足球为目标。”这是规则警告之一。过了一个半世纪，还是有人因为两者相似的形状，分不清足球和对手的脑袋。&lt;/p&gt;

&lt;p&gt;伦敦协议中没有规定球员的人数、球场的大小、球门的高度和比赛的时间。球赛能持续两三个小时，每当球飞远的时候，球赛的主角们可以抽烟聊天。彼时还建立了一个现代规则：越位。在对手的背后射门得分是不诚实的。&lt;/p&gt;

&lt;p&gt;那时候球员没有特定的场上位置：他们全都欢快地追着球跑，想到哪儿就到哪儿，每个人都可以随意改变位置。在1870年左右，苏格兰人开始按后防、中场和前锋来组织球队，此时每队有11名队员。从1869年开始，不允许任何球员用手触球，连用手捡球，然后把球放好来踢都不允许。1871年这个禁令的例外诞生了：守门员可以用他的整个身体阻挡进球。&lt;/p&gt;

&lt;p&gt;守门员过去保护的球门是一个比今天的球门窄而高的方形堡垒，由两根立柱系一根带子组成，带子高于地面5.5米，1875年带子被一根木制的横梁所取代。过去在立柱上刻线来记录一个个的进球，现在采用了电子记分板，不过原来“刻上一个进球”的含义就消失了。在有些国家球门被称作“拱门”，而守门员则叫做“拱门守护者”，但是球门上都是直角并没有弧度，这大概是因为英国大学的学生们过去用校园的拱门做球门吧。&lt;/p&gt;

&lt;p&gt;1872年，裁判出现了，在此之前球员们是他们自己的法官，他们自己处罚犯规的球员。1880年，裁判手中有了计时器，他成了决定比赛何时结束、谁被罚下场的法官，但是他仍然只能在边线上喊叫着执法比赛。1891年裁判第一次踏上了球场，吹罚了历史上的第一个点球，并踱了12步指定了罚球地点。有一段时间英国的媒体对点球青睐有加，认为它保护了处于球门前的进攻队员，那里像是难以置信的屠宰场，《威斯敏斯特公报》就曾刊登过一串为球场暴力致死致残的令人毛骨悚然的名单。&lt;/p&gt;

&lt;p&gt;1882年英国足球当局引入了掷界外球，8年后用石灰画出了球场区域，并在球场中央画出了中圈。同一年给球门加上了球网以截住皮球，并消除了是否进球得分的疑问。&lt;/p&gt;

&lt;p&gt;19世纪过去了，随之而去的是英国对足球的垄断。1904年，国际足球联合会（FIFA）成立了，从此以后全世界范围内足球和脚之间的关系都由它掌管。此后出现了很多足球锦标赛，在所有这些比赛中使用的规则与英国最初采用的没有太大区别。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;［1］1863年10月26日，英国人在伦敦成立了世界第一个足球协会，同时制定和通过了世界第一部较为统一的足球竞赛规则，并以文字形式记载下来。这一天被公认为现代足球的诞生日。&lt;br /&gt;
［2］“to score a goal”本意为刻上一个进球，“score”有“刻”的意思。&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        <pubDate>Wed, 29 Aug 2018 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2018/08/29/zuqiuwangshi-1/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/08/29/zuqiuwangshi-1/</guid>
        
        <category>《足球往事》</category>
        
        <category>书摘</category>
        
        
      </item>
    
      <item>
        <title>Ubuntu 常用命令整理</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;Vue.js 放弃中…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;目录&quot;&gt;&lt;strong&gt;目录:&lt;/strong&gt;&lt;/h2&gt;

&lt;h2 id=&quot;一用户操作&quot;&gt;&lt;a href=&quot;#0&quot;&gt;一、用户操作&lt;/a&gt;&lt;/h2&gt;

&lt;h2 id=&quot;二文件操作&quot;&gt;&lt;a href=&quot;#1&quot;&gt;二、文件操作&lt;/a&gt;&lt;/h2&gt;

&lt;h2 id=&quot;三系统操作&quot;&gt;&lt;a href=&quot;#2&quot;&gt;三、系统操作&lt;/a&gt;&lt;/h2&gt;

&lt;p id=&quot;0&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;一用户操作-1&quot;&gt;一、用户操作&lt;/h2&gt;

&lt;p&gt;在root用户下，&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;使用&lt;code class=&quot;highlighter-rouge&quot;&gt;who&lt;/code&gt;查看目前有哪些用户登录了服务器；&lt;/li&gt;
  &lt;li&gt;使用&lt;code class=&quot;highlighter-rouge&quot;&gt;pkill -kill -t pts/1&lt;/code&gt;（数字1就是用户的&lt;a href=&quot;https://en.wikipedia.org/wiki/Tty_(unix)&quot;&gt;TTY&lt;/a&gt;）强制退出对应用户的登陆；&lt;/li&gt;
  &lt;li&gt;增加用户：&lt;code class=&quot;highlighter-rouge&quot;&gt;useradd test&lt;/code&gt;；为新增用户添加密码：&lt;code class=&quot;highlighter-rouge&quot;&gt;passwd test&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;删除用户：&lt;code class=&quot;highlighter-rouge&quot;&gt;userdel test&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;用户登陆记录：&lt;code class=&quot;highlighter-rouge&quot;&gt;last&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;用户登陆失败记录：&lt;code class=&quot;highlighter-rouge&quot;&gt;lastb&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;查看系统下所有用户：&lt;code class=&quot;highlighter-rouge&quot;&gt;cat /etc/passwd |awk -F \: '{print $1}'&lt;/code&gt;;&lt;/li&gt;
&lt;/ol&gt;

&lt;p id=&quot;1&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;二文件操作-1&quot;&gt;二、文件操作&lt;/h2&gt;

&lt;p&gt;文件操作命令：&lt;/p&gt;

&lt;p&gt;1、ls&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 格式：ls 目录

 ls命令用于显示文件下有哪些文件。a
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;2、touch&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 格式：touch test1 test2 test3

 touch命令用于创建文件，可以同一时间创建多个文件。
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;3、rm&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 格式：rm 文件    

 rm命令用于删除文件，当文件不能够被删除时可以加上 -f 选项，强制将文件删除。
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;4、cat&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 格式：cat /proc/cpuinfo

 cat命令用于查看文件内的信息。如果只想查看某一项内容时，要加上grep选项。

 例如：cat /proc/meminfo |grep MemTotal
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;5、less&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 格式：less /proc/meminfo

 less命令也是用来查看文件的内容的命令，但是他显示时是一屏一屏的显示地。

      a、按下空格键后进入到下一屏。

      b、还可以通过上下键来上下移动行。

      c、按下 q 键后退出查看。
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;6、more&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 格式：more /proc/meminfo

 more命令与less命令一样用于查看文件内的内容，同样是分屏显示的。

      a、按下空格键后进入到下一屏

      b、按下 q 键后退出查看
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;7、cp&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 格式：cp /etc/apt/sources.list /etc/aptsources.listbacker

 cp是copy的缩写用于复制文件。
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;8、mv&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 格式：mv /home/user1/桌面/ruijie/xrgsu /usr/share/local/bin/xrgsu

 mv命令是用于移动文件的。
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;9、find&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 格式：sudo find / -name ls

 find命令是用于查找文件：

      a、／ 表示的是查找的起始目录，

      b、-name 有了这个选项，在显示只有找到的结果才会显示出来。

      c、ls 为你要找的目录文件。
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;mkdir 文件夹 –/创建一个文件夹&lt;/p&gt;

&lt;p&gt;rmdir 空文件夹名 –/删除一个空文件夹&lt;/p&gt;

&lt;p&gt;rm 文件名 文件名 –/删除一个文件或多个文件&lt;/p&gt;

&lt;p&gt;rm -rf 非空文件夹名 –/删除一个非空文件夹下的一切&lt;/p&gt;

&lt;p&gt;——————&lt;/p&gt;

&lt;p&gt;通过ssh终端从本地拷贝文件到服务器：&lt;/p&gt;

&lt;p&gt;使用方式如下：&lt;/p&gt;

&lt;p&gt;1、上传本地文件到服务器&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;scp /path/filename username@servername:/path/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;例如scp /var/www/test.php root@192.168.0.101:/var/www/ 把本机/var/www/目录下的test.php文件上传到192.168.0.101这台服务器上的/var/www/目录中&lt;/p&gt;

&lt;p&gt;2、从服务器上下载文件&lt;/p&gt;

&lt;p&gt;下载文件我们经常使用wget，但是如果没有http服务，如何从服务器上下载文件呢?&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;scp username@servername:/path/filename /var/www/local_dir(本地目录)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;例如scp root@192.168.0.101:/var/www/test.txt 把192.168.0.101上的/var/www/test.txt 的文件下载到/var/www/local_dir(本地目录)&lt;/p&gt;

&lt;p&gt;3、从服务器下载整个目录&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;scp -r username@servername:/var/www/remote_dir/(远程目录) /var/www/local_dir(本地目录)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;例如:scp -r root@192.168.0.101:/var/www/test /var/www/&lt;/p&gt;

&lt;p&gt;4、上传目录到服务器&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;scp -r local_dir username@servername:remote_dir
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;例如：scp -r test root@192.168.0.101:/var/www/ 把当前目录下的test目录上传到服务器的/var/www/ 目录&lt;/p&gt;

&lt;p id=&quot;2&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;三系统操作-1&quot;&gt;三、系统操作&lt;/h2&gt;

&lt;p&gt;太多了，每次还是查&lt;a href=&quot;https://wiki.ubuntu.com.cn/%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8C%87%E5%8D%97#.E5.B8.B8.E7.94.A8.E6.8C.87.E4.BB.A4&quot;&gt;官方wiki&lt;/a&gt;快一点&lt;/p&gt;

&lt;p&gt;Unix/Linux下一般比如想让某个程序在后台运行，很多都是使用&amp;amp; 在程序结尾来让程序自动运行。比如我们要运行mysql在后台：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/local/mysql/bin/mysqld_safe --user=mysql &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;但是加入我们很多程序并不象mysqld一样做成守护进程，可能我们的程序只是普通程序而已，一般这种程序使用&amp;amp; 结尾，但是如果终端关闭，那么程序也会被关闭。但是为了能够后台运行，那么我们就可以使用nohup这个命令，比如我们有个test.php需要在后台运行，并且希望在后台能够定期运行，那么就使用nohup：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nohup /root/test.php &amp;amp; 　　 提示：

　[~]$ appending output to nohup.out
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;　　嗯，证明运行成功，同时把程序运行的输出信息放到当前目录的nohup.out 文件中去。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    tcpdump -i any -nn 'port 8338' -vv -X //监听端口数据

    lsof -i:端口号 //查看特定端口占用情况

    lsof -i //查看所有端口占用情况
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;查看系统进程&amp;amp;启动项：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    top //查看当前所有进程，敲p可以按CPU占用率排序
    ls -l /etc/init.d //查看所有开启启动项，此处可以检查是否有恶意程序和木马
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;http://www.cnblogs.com/myitm/archive/2011/10/16/2214448.html&quot;&gt;其它相关参考&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;四mac常用命令备份plus&quot;&gt;四、MAC常用命令备份(plus)&lt;/h2&gt;

&lt;p&gt;结束php-fpm进程:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    sudo kill -INT `cat /usr/local/var/run/php-fpm.pid`
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;开始php-fpm进程：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    sudo php-fpm
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;设置本地80端口虚拟域名&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    sudo vim /private/etc/hosts
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;git记住所有的https账号密码，长期&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    git config --global credential.helper store
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;git记住所有的https账号密码，临时&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    git config credential.helper 'cache --timeout=3600'
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;在dock创建一个透明icon，分割dock&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    defaults write com.apple.dock persistent-apps -array-add '{ &quot;tile-type&quot; = &quot;spacer-tile&quot;; }' killall Dock
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/0%20%2837%29.gif&quot; /&gt; &lt;/td&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/1490924677.png&quot; /&gt;&lt;div&gt;&lt;small class=&quot;img-hint&quot;&gt;这不是收钱的  加个好友而已&lt;/small&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</description>
        <pubDate>Tue, 06 Feb 2018 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2018/02/06/Linux-orders-note/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/02/06/Linux-orders-note/</guid>
        
        <category>笔记</category>
        
        <category>Linux</category>
        
        <category>Ubuntu</category>
        
        
      </item>
    
      <item>
        <title>用DiscuzX3.2建站玩耍</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;Vue.js 放弃中…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;目录&quot;&gt;&lt;strong&gt;目录:&lt;/strong&gt;&lt;/h2&gt;

&lt;h2 id=&quot;一简述&quot;&gt;&lt;a href=&quot;#0&quot;&gt;一、简述&lt;/a&gt;&lt;/h2&gt;

&lt;h2 id=&quot;二安装配置&quot;&gt;&lt;a href=&quot;#1&quot;&gt;二、安装配置&lt;/a&gt;&lt;/h2&gt;

&lt;h2 id=&quot;三配置文件&quot;&gt;&lt;a href=&quot;#2&quot;&gt;三、配置文件&lt;/a&gt;&lt;/h2&gt;

&lt;p id=&quot;0&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;一简述-1&quot;&gt;一、简述&lt;/h2&gt;

&lt;p&gt;Discuz是主流的社区论坛管理方案，小米论坛、威锋论坛等国内知名论坛均使用的是Discuz的框架进行二次开发和内容管理，这里不多赘述。&lt;/p&gt;

&lt;p&gt;有一件轶事可以分享一下：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Discuz的第一位商业用户是“香港警察俱乐部”（Discuz亦为其量身订造了特有的程序），当时候Discuz的作者戴志康还在念大学，在沈阳的大学宿舍居住，香港警察俱乐部的网主每次打电话找他都要经过大学的总机转接他来听电话，那时候他连手机都还没有，可是今天他已经成为百万美元注册的集团董事了，香港警察俱乐部亦顺理成章成了他第一个商业客户，后来他的同事还跟香港警察俱乐部的网主说，正因为当初香港警察俱乐部向他购买了他写的这款程序，所以坚定了他们后来的创业道路，他笑着说：“你（香港警察俱乐部的网主）的一个不经意的决定，改变了另一个人的命运。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p id=&quot;1&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;二安装配置-1&quot;&gt;二、安装配置&lt;/h2&gt;

&lt;p&gt;首先去&lt;a href=&quot;http://www.discuz.net/forum-10-1.html&quot;&gt;官网&lt;/a&gt;下载程序安装包，我选择的是X3.2版本。&lt;/p&gt;

&lt;p&gt;解压后部署到自己的服务器上、&lt;/p&gt;

&lt;p&gt;关于如何部署服务器有一万种方法，这里我用的是&lt;a href=&quot;https://blog.izgq.net/archives/763/&quot;&gt;Ubuntu+Nginx+Mysql&lt;/a&gt;的方案。&lt;/p&gt;

&lt;p&gt;完成服务器的部署后，就是选择一个域名解析并指向服务器。&lt;/p&gt;

&lt;p&gt;这里以&lt;a href=&quot;http://www.freedivefamily.com&quot;&gt;http://www.freedivefamily.com&lt;/a&gt;为例。&lt;/p&gt;

&lt;p&gt;接下来开始在本地浏览器中安装 Discuz! X3，在浏览器中运行： http://www.freedivefamily.com/bbs/install/ 开始全新安装。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.discuz.net/data/attachment/forum/201304/28/133039m7f83jye3fsqgf0q.gif.thumb.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;阅读授权协议后点击“我同意”，系统会自动检查环境及文件目录权限，这里文件读写状态出现异常的同学请自行谷歌解决，因为我一次通关。&lt;/p&gt;

&lt;p&gt;检测成功，点击“下一步”，即进入检测服务器环境以及设置 UCenter 界面，如下图所示：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.discuz.net/data/attachment/forum/201304/28/133039wn8cihhf1fk8chnk.gif.thumb.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;点击“下一步”，进入安装数据库的界面，如下图所示：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.discuz.net/data/attachment/forum/201304/28/133040b7b3g7z7b7urg2bp.gif.thumb.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;填写好 Discuz! X 数据库信息及管理员信息。
点击“下一步”，系统会自动安装数据库直至完毕。&lt;/p&gt;

&lt;p&gt;安装成功后，就会自动跳转到Discuz的欢迎界面。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.discuz.net/data/attachment/forum/201304/28/133041r7g9ux7geq557rx7.gif.thumb.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这里，建议直接开通云平台，因为后期通过后台再开通会遇到很多问题，亲测采坑。&lt;/p&gt;

&lt;p&gt;至此，Discuz! X3.2 已经成功地安装完毕!&lt;/p&gt;

&lt;p id=&quot;2&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;三配置文件-1&quot;&gt;三、配置文件&lt;/h2&gt;

&lt;p&gt;Discuz！安装成功后，后台配置都很简单，难度就在于站内优化和SEO相关设置了。&lt;/p&gt;

&lt;p&gt;简单总结就是：生命不息，优化不止……&lt;/p&gt;

&lt;p&gt;除此之外，特别介绍一下几个基本的配置文件&lt;/p&gt;

&lt;p&gt;配置文件：&lt;/p&gt;

&lt;p&gt;config下config_global.php，config_ucenter.php，uc_server\data下的config.inc.php&lt;/p&gt;

&lt;p&gt;主要说配置文件config下config_ucenter.php和uc_server\data下的config.inc.php&lt;/p&gt;

&lt;p&gt;配置文件config下config_ucenter.php对应后台–站长–ucenter设置&lt;/p&gt;

&lt;p&gt;UCenter 应用 ID:1 　　　define(‘UC_APPID’, ‘1’);&lt;/p&gt;

&lt;p&gt;UCenter 通信密钥:B0Z9k2pbX7j5J1H9zfgdVeDaY8I2I2zfUc00C1J4B4ga9fNdOed7X7p3S5ubD2ba&lt;/p&gt;

&lt;p&gt;define(‘UC_KEY’, ‘B0Z9k2pbX7j5J1H9zfgdVeDaY8I2I2zfUc00C1J4B4ga9fNdOed7X7p3S5ubD2ba’);&lt;/p&gt;

&lt;p&gt;UCenter 访问地址:http://localhost/uc_server 　　define(‘UC_API’, ‘http://localhost/uc_server’);&lt;/p&gt;

&lt;p&gt;UCenter IP 地址:127.0.0.1 　　define(‘UC_IP’, ‘127.0.0.1’);&lt;/p&gt;

&lt;p&gt;UCenter 连接方式:数据库方式 　　define(‘UC_CONNECT’, ‘mysql’);&lt;/p&gt;

&lt;p&gt;UCenter 数据库服务器:localhost 　　define(‘UC_DBHOST’, ‘localhost’);&lt;/p&gt;

&lt;p&gt;UCenter 数据库用户名:root 　　define(‘UC_DBUSER’, ‘root’);&lt;/p&gt;

&lt;p&gt;UCenter 数据库密码:***　　 define(‘UC_DBPW’, ‘123’);&lt;/p&gt;

&lt;p&gt;UCenter 数据库名:x2 　　define(‘UC_DBNAME’, ‘x2’);&lt;/p&gt;

&lt;p&gt;UCenter 表前缀:pre_ucenter_ 　　define(‘UC_DBTABLEPRE’, ‘&lt;code class=&quot;highlighter-rouge&quot;&gt;x2&lt;/code&gt;.pre_ucenter_’);&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/0%20%2837%29.gif&quot; /&gt; &lt;/td&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/1490924677.png&quot; /&gt;&lt;div&gt;&lt;small class=&quot;img-hint&quot;&gt;这不是收钱的  加个好友而已&lt;/small&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</description>
        <pubDate>Fri, 22 Dec 2017 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2017/12/22/Discuzu-Build-Config/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/22/Discuzu-Build-Config/</guid>
        
        <category>笔记</category>
        
        <category>Discuz</category>
        
        <category>论坛</category>
        
        <category>建站</category>
        
        <category>站长</category>
        
        
      </item>
    
      <item>
        <title>用Ubuntu爱国原来这么简单！</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;Vue.js 放弃中…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;目录:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#0&quot;&gt;一、简述&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#1&quot;&gt;二、基本环境&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#2&quot;&gt;三、配置文件&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#3&quot;&gt;四、配置自动运行&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#4&quot;&gt;五、常用命令&lt;/a&gt;&lt;/p&gt;

&lt;p id=&quot;0&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;一简述&quot;&gt;一、简述&lt;/h2&gt;

&lt;p&gt;本教程旨在提供简明的Ubuntu 16.04下安装服务器端Shadowsocks。不同于Ubuntu 16.04之前的教程，本文抛弃initd，转而使用Ubuntu 16.04支持的Systemd管理Shadowsocks的启动与停止，显得更为便捷。优化部分包括BBR、TCP Fast Open以及吞吐量优化。&lt;/p&gt;

&lt;p&gt;本教程仅适用于Ubuntu 16.04及之后的版本，基于Python 3，支持IPv6。&lt;/p&gt;

&lt;p id=&quot;1&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;二基本环境&quot;&gt;二、基本环境&lt;/h2&gt;

&lt;p&gt;本教程使用Python 3为载体，因Python 3对应的包管理器&lt;code class=&quot;highlighter-rouge&quot;&gt;pip3&lt;/code&gt;并未预装，首先安装&lt;code class=&quot;highlighter-rouge&quot;&gt;pip3&lt;/code&gt;：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 获取root权限
sudo -s

# 更新apt-get
apt-get update

# 安装python包管理工具
apt-get install python-setuptools
sudo apt install python3-pip
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;因Shadowsocks作者不再维护pip中的Shadowsocks（定格在了2.8.2），我们使用下面的命令来安装最新版的Shadowsocks：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip3 install https://github.com/shadowsocks/shadowsocks/archive/master.zip
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;安装完成后可以使用下面这个命令查看Shadowsocks版本：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo ssserver --version
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;目前会显示“Shadowsocks 3.0.0”。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;注意！&lt;/strong&gt;如果报错&lt;code class=&quot;highlighter-rouge&quot;&gt;unsupported locale setting&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;只需要转化一下语言配置即可：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;export LC_ALL=C
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p id=&quot;2&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;三配置文件&quot;&gt;三、配置文件&lt;/h2&gt;

&lt;p&gt;创建Shadowsocks配置文件所在文件夹：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mkdir /etc/shadowsocks
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;然后创建配置文件：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo nano /etc/shadowsocks/config.json
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;复制粘贴如下内容：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;server&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;your_server_ip&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//注意：这里指本地IP或云服务器内网IP;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;server_port&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8388&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;local_address&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;local_port&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1080&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;mypassword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//注意修改密码“password”;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;timeout&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;method&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;aes-256-cfb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;fast_open&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;然后按Ctrl + O保存文件，Ctrl + X退出。&lt;/p&gt;

&lt;p&gt;测试下Shadowsocks能不能正常工作了：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssserver -c /etc/shadowsocks/config.json
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;在Shadowsocks客户端添加服务器，如果你使用的是我提供的那个配置文件的话，地址填写你的IPv4地址或IPv6地址，端口号为8388，加密方法为aes-256-cfb，密码为你设置的密码。然后设置客户端使用全局模式，浏览器登录Google试试应该能直接打开了。&lt;/p&gt;

&lt;p&gt;这时浏览器登录http://ip138.com/就会显示Shadowsocks服务器的IP啦！&lt;/p&gt;

&lt;p&gt;测试完毕，按Ctrl + C关闭Shadowsocks。&lt;/p&gt;

&lt;p id=&quot;3&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;四配置自动运行&quot;&gt;四、配置自动运行&lt;/h2&gt;

&lt;p&gt;新建Shadowsocks管理文件&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo nano /etc/systemd/system/shadowsocks-server.service
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;复制粘贴：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Unit]
Description=Shadowsocks Server
After=network.target

[Service]
ExecStart=/usr/local/bin/ssserver -c /etc/shadowsocks/config.json
Restart=on-abort

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Ctrl + O保存文件，Ctrl + X退出。&lt;/p&gt;

&lt;p&gt;启动Shadowsocks：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl start shadowsocks-server
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;设置开机启动Shadowsocks：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl enable shadowsocks-server
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;至此，Shadowsock服务器端的基本配置已经全部完成了！&lt;/p&gt;

&lt;p id=&quot;4&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;常用命令&quot;&gt;&lt;strong&gt;常用命令：&lt;/strong&gt;&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;systemctl start shadowsocks //启动SS
systemctl enable shadowsocks //停止SS
systemctl status shadowsocks//查看SS状态
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;厉害的一个命令&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tcpdump -i any -nn 'port 8338' -vv -X //监听端口数据
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;-i interface，网卡的名称，后面可以跟具体的网卡名称(ifconfig后者tcpdump -D)获取，笔者的电脑上看到any，似乎是指所有的网卡&lt;/p&gt;

  &lt;p&gt;-nn 监听host或者port名，这个网上解释有一大堆，什么src host，dist host  ，比如我要抓，ip地址为127.0.0.1，端口为9002的服务器的数据包，那么命令可以写成-nn ‘src host 127.0.0.1 and &amp;gt;port 9002’.不过实际来讲，端口肯定是被一个ip地址使用的，而且对于我来说，服务器抓包比较有意义，所以，其实有没有ip地址，似乎显得不那么重要，有端口就可以。&lt;/p&gt;

  &lt;p&gt;-vv 详细信息&lt;/p&gt;

  &lt;p&gt;-X 以16进制的格式输出&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;附加题优化吞吐量&quot;&gt;附加题、优化吞吐量&lt;/h2&gt;

&lt;p&gt;新建配置文件：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo nano /etc/sysctl.d/local.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;复制粘贴：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# max open files
fs.file-max = 51200
# max read buffer
net.core.rmem_max = 67108864
# max write buffer
net.core.wmem_max = 67108864
# default read buffer
net.core.rmem_default = 65536
# default write buffer
net.core.wmem_default = 65536
# max processor input queue
net.core.netdev_max_backlog = 4096
# max backlog
net.core.somaxconn = 4096

# resist SYN flood attacks
net.ipv4.tcp_syncookies = 1
# reuse timewait sockets when safe
net.ipv4.tcp_tw_reuse = 1
# turn off fast timewait sockets recycling
net.ipv4.tcp_tw_recycle = 0
# short FIN timeout
net.ipv4.tcp_fin_timeout = 30
# short keepalive time
net.ipv4.tcp_keepalive_time = 1200
# outbound port range
net.ipv4.ip_local_port_range = 10000 65000
# max SYN backlog
net.ipv4.tcp_max_syn_backlog = 4096
# max timewait sockets held by system simultaneously
net.ipv4.tcp_max_tw_buckets = 5000
# turn on TCP Fast Open on both client and server side
net.ipv4.tcp_fastopen = 3
# TCP receive buffer
net.ipv4.tcp_rmem = 4096 87380 67108864
# TCP write buffer
net.ipv4.tcp_wmem = 4096 65536 67108864
# turn on path MTU discovery
net.ipv4.tcp_mtu_probing = 1

net.ipv4.tcp_congestion_control = bbr
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;运行：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sysctl --system
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;编辑之前的shadowsocks-server.service文件：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo nano /etc/systemd/system/shadowsocks-server.service
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;在&lt;code class=&quot;highlighter-rouge&quot;&gt;ExecStart&lt;/code&gt;前插入一行，内容为：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ExecStartPre=/bin/sh -c 'ulimit -n 51200'
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;即修改后的shadowsocks-server.service内容为：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Unit]
Description=Shadowsocks Server
After=network.target

[Service]
ExecStartPre=/bin/sh -c 'ulimit -n 51200'
ExecStart=/usr/local/bin/ssserver -c /etc/shadowsocks/config.json
Restart=on-abort

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Ctrl + O保存文件，Ctrl + X退出。&lt;/p&gt;

&lt;p&gt;重载shadowsocks-server.service：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl daemon-reload
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;重启Shadowsocks：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl restart shadowsocks-server
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;TCP Fast Open可以降低Shadowsocks服务器和客户端的延迟。实际上在上一步已经开启了TCP Fast Open，现在只需要在Shadowsocks配置中启用TCP Fast Open。&lt;/p&gt;

&lt;p&gt;编辑config.json：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo nano /etc/shadowsocks/config.json
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;将fast_open的值由false修改为true。Ctrl + O保存文件，Ctrl + X退出。&lt;/p&gt;

&lt;p&gt;重启Shadowsocks：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl restart shadowsocks-server

注意：TCP Fast Open同时需要客户端的支持，即客户端Linux内核版本为3.7.1及以上；你可以在Shadowsocks客户端中启用TCP Fast Open。

至此，Shadowsock服务器端的优化已经全部完成了！
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;推荐AWS新注册绑信用卡送一年EC2，东京节点不错，俄亥俄亲测慢成狗。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.polarxiong.com/archives/Ubuntu-16-04%E4%B8%8BShadowsocks%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BC%98%E5%8C%96.html&quot;&gt;启蒙教程&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/0%20%2837%29.gif&quot; /&gt; &lt;/td&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/1490924677.png&quot; /&gt;&lt;div&gt;&lt;small class=&quot;img-hint&quot;&gt;这不是收钱的  加个好友而已&lt;/small&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</description>
        <pubDate>Tue, 14 Nov 2017 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2017/11/14/shadowsocks-ubuntu/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/11/14/shadowsocks-ubuntu/</guid>
        
        <category>笔记</category>
        
        <category>Linux</category>
        
        
      </item>
    
      <item>
        <title>Ubuntu下Nginx配置笔记</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;Vue.js 放弃中…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;阿里云双十一活动还算良心,赶紧买个服务器自己玩.&lt;/p&gt;

&lt;p&gt;本着日后方便科学上网的原则,买了2核4G,1M带宽的香港节点3年,搭载Ubuntu 16.0402系统镜像.&lt;/p&gt;

&lt;p&gt;本地环境:MAC OS Sierra 10.12.3&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;本文分四个部分:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#0&quot;&gt;一、使用SSH通过MAC同Ubuntu建立连接&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#1&quot;&gt;二、Ubuntu服务器基本设置&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#2&quot;&gt;三、环境搭建&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#3&quot;&gt;四、配置多个站点&lt;/a&gt;&lt;/p&gt;

&lt;p id=&quot;0&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;一使用ssh通过mac同ubuntu建立连接&quot;&gt;一、使用SSH通过MAC同Ubuntu建立连接&lt;/h3&gt;

&lt;h4 id=&quot;1ubuntu端&quot;&gt;1.Ubuntu端&lt;/h4&gt;

&lt;p&gt;在ubuntu终端上输入&lt;code class=&quot;highlighter-rouge&quot;&gt;root@ubuntu:~$ sudo apt-get install openssh-server&lt;/code&gt;命令安装openssh-server.(阿里云生成的系统登陆后,默认是root角色)&lt;/p&gt;

&lt;p&gt;一般报错有两个可能的原因,一个是apt版本过老,办法是update一下;另一个是apt的lists损坏,办法是用如下命令来删除已经损坏的lists.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;`root@ubuntu:~$ sudo rm /var/lib/apt/lists/* -vf`
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;2mac端&quot;&gt;2.MAC端&lt;/h4&gt;

&lt;p&gt;在终端上输入&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh root@your_server_ip
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;跟着指引输入服务器密码即可,是不是敲简单.&lt;/p&gt;

&lt;p&gt;如果不想每次输入IP,可以在 /.ssh/config 里进行配置,🌰如下:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Host mylinux
    HostName ***.***.***.***
    Port 22
    User root
    IdentityFile /Users/***/.ssh/mylinux \\这里是ssh私钥的路径,不作不用动
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;像上面这样配置后,每次只需要在终端敲入:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh mylinux
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;即可!&lt;/p&gt;

&lt;p&gt;找不到&lt;code class=&quot;highlighter-rouge&quot;&gt;/Users/***/.ssh&lt;/code&gt;文件夹?
用下面的命令可以显示MAC隐藏文件.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;defaults write com.apple.finder AppleShowAllFiles -bool true
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p id=&quot;1&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;二ubuntu服务器基本设置&quot;&gt;二、Ubuntu服务器基本设置&lt;/h3&gt;

&lt;h4 id=&quot;使用root登录服务器&quot;&gt;使用root登录服务器&lt;/h4&gt;

&lt;p&gt;首先我们需要使用刚刚配置好的root用户ssh登录服务器:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;local$ ssh root@SERVER_IP_ADDRESS
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;前面的local$表示是在本地机器操作,在服务器端,该提示符会类似&lt;code class=&quot;highlighter-rouge&quot;&gt;root@my-remote-server:~$&lt;/code&gt;这种形式,后边会看到。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Tips: 如果使用的是腾讯云，其初始登录默认使用的是用户ubuntu，并不是root。因此，使用ssh ubuntu@your_server_ip登录之后可以修改下root的密码，然后就可以切换到用户root了。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;修改密码命令如下：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ubuntu@VM-42-158-ubuntu:~$ sudo passwd root
Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;有可能还需要编辑配置文件/etc/ssh/sshd_config中的PermitRootLogin的设置。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;buntu@VM-42-158-ubuntu:~$ su
Password:
root@VM-42-158-ubuntu:/#
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;新增超级用户权限用户&quot;&gt;新增超级用户权限用户&lt;/h4&gt;

&lt;p&gt;root用户虽然强大,但是正是由于太强大了,所以显得不够安全,因此通常情况下我们需要创建一个新的用户,然后给他设置超级用户(superuser)权限,这样就可以安全的进行各种操作了。&lt;/p&gt;

&lt;p&gt;使用root用户登录,做如下操作:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@my-remote-server:~$ adduser dennis
root@my-remote-server:~$ usermod -aG sudo dennis
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;这里就将新创建的用户加入了sudo用户组,就具有了超级用户的权限。更详细的信息可以参考&lt;a href=&quot;https://www.digitalocean.com/community/tutorials/how-to-edit-the-sudoers-file-on-ubuntu-and-centos&quot;&gt;这个教程&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;然后我们就可以以新创建的用户登录了:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@my-remote-server:~# su - dennis
dennis@my-remote-server:~$
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p id=&quot;2&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;三环境搭建&quot;&gt;三、环境搭建&lt;/h3&gt;

&lt;h4 id=&quot;安装nginx&quot;&gt;安装Nginx&lt;/h4&gt;

&lt;p&gt;在ubuntu上安装软件很简单,使用apt-get即可。注意由于权限问题,需要在前面加sudo。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
sudo apt-get install nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;踩坑提醒&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;安装nginx时出现错误&quot;&gt;安装Nginx时出现错误&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dennis@my-remote-server:~$ sudo apt-get install nginx
Reading package lists... Done
Building dependency tree
Reading state information... Done
nginx is already the newest version (1.10.0-0ubuntu0.16.04.2).
0 upgraded, 0 newly installed, 0 to remove and 42 not upgraded.
2 not fully installed or removed.
After this operation, 0 B of additional disk space will be used.
Do you want to continue? [Y/n]
Setting up nginx-core (1.10.0-0ubuntu0.16.04.2) ...
Job for nginx.service failed because the control process exited with error code. See &quot;systemctl status nginx.service&quot; and &quot;journalctl -xe&quot; for details.
invoke-rc.d: initscript nginx, action &quot;start&quot; failed.
dpkg: error processing package nginx-core (--configure):
 subprocess installed post-installation script returned error exit status 1
dpkg: dependency problems prevent configuration of nginx:
 nginx depends on nginx-core (&amp;gt;= 1.10.0-0ubuntu0.16.04.2) | nginx-full (&amp;gt;= 1.10.0-0ubuntu0.16.04.2) | nginx-light (&amp;gt;= 1.10.0-0ubuntu0.16.04.2) | nginx-extras (&amp;gt;= 1.10.0-0ubuntu0.16.04.2); however:
  Package nginx-core is not configured yet.
  Package nginx-full is not installed.
  Package nginx-light is not installed.
  Package nginx-extras is not installed.
 nginx depends on nginx-core (&amp;lt;&amp;lt; 1.10.0-0ubuntu0.16.04.2.1~) | nginx-full (&amp;lt;&amp;lt; 1.10.0-0ubuntu0.16.04.2.1~) | nginx-light (&amp;lt;&amp;lt; 1.10.0-0ubuntu0.16.04.2.1~) | nginx-extras (&amp;lt;&amp;lt; 1.10.0-0ubuntu0.16.04.2.1~); however:
  Package nginx-core is not configured yet.
  Package nginx-full is not installed.
  Package nginx-light is not installed.
  Package nginx-extras is not installed.
dpkg: error processing package nginx (--configure):
 dependency problems - leaving unconfigured
Errors were encountered while processing:
 nginx-core
 nginx
E: Sub-process /usr/bin/dpkg returned an error code (1)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;原因分析&lt;/p&gt;

&lt;p&gt;Google了一下,发现出现这种错误,一般应该是由于其他应用占用了80端口。可以这样来看下:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dennis@myserver:~$ sudo netstat -nlp
sudo: unable to resolve host myserver
[sudo] password for dennis:
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      132/rpcbind
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      332/apache2
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      269/sshd
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN      454/master
tcp6       0      0 :::111                  :::*                    LISTEN      132/rpcbind
tcp6       0      0 :::22                   :::*                    LISTEN      269/sshd
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;果然80端口被默认安装的apache给占掉了,所以需要干掉占用80端口的apache2：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo kill -9 332
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;运行apt-get命令更新或安装软件出现Setting locale failed错误&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE = (unset),
	LC_ALL = (unset),
	LC_CTYPE = &quot;en_US.UTF-8&quot;,
	LANG = &quot;en_US.UTF-8&quot;
    are supported and installed on your system.
perl: warning: Falling back to the standard locale (&quot;C&quot;).
locale: Cannot set LC_CTYPE to default locale: No such file or directory
locale: Cannot set LC_MESSAGES to default locale: No such file or directory
locale: Cannot set LC_ALL to default locale: No such file or directory
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;解决办法：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo ap-get update
apt-get install language-pack-en
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;nginx-常用目录&quot;&gt;Nginx 常用目录&lt;/h5&gt;

&lt;p&gt;内容&lt;/p&gt;

&lt;p&gt;/var/www/html: 保存web网页内容的默认目录&lt;/p&gt;

&lt;p&gt;服务器配置&lt;/p&gt;

&lt;p&gt;/etc/nginx: nginx 配置目录。所有Nginx相关的配置文件都在这里。
/etc/nginx/nginx.conf: Nginx主配置文件,进行全局默认设置。
/etc/nginx/sites-available: 针对每个”server blocks”独立的配置文件。这里的配置文件并不被直接使用,只有软连接到site-enabled的配置才会真正生效。
/etc/nginx/sites-enabled/: 针对每个”server blocks”独立的配置文件。由sites-available链接过来。
/etc/nginx/snippets: 一些配置脚本片段。&lt;/p&gt;

&lt;p&gt;服务器日志&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/var/log/nginx/access.log: &lt;/code&gt;默认保存所有与web服务交互的请求。
&lt;code class=&quot;highlighter-rouge&quot;&gt;/var/log/nginx/error.log: &lt;/code&gt;Nginx的错误日志&lt;/p&gt;

&lt;h4 id=&quot;顺便安装一下mysql&quot;&gt;顺便安装一下MySQL&lt;/h4&gt;

&lt;h5 id=&quot;安装&quot;&gt;安装&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
sudo apt-get install mysql-server
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;配置&quot;&gt;配置&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mysql_secure_installation
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;查看mysql的版本&quot;&gt;查看MySQL的版本：&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql --version
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;初始化&quot;&gt;初始化&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mysqld --initialize
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;如果是如上面那样通过apt-get安装的，这一步通常已经被做了。因此会有如下错误提示：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[ERROR] --initialize specified but the data directory has files in it. Aborting.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;mysql的启动和停止&quot;&gt;MySQL的启动和停止&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo /etc/init.d/mysql start
sudo /etc/init.d/mysql stop
sudo /etc/init.d/mysql restart
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;或者&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo start mysql
sudo stop mysql
sudo restart mysql
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;测试连接&quot;&gt;测试连接&lt;/h5&gt;

&lt;p&gt;可以通过&lt;code class=&quot;highlighter-rouge&quot;&gt;mysqladmin -p -u root version&lt;/code&gt;命令来测试一下mysql连接是否正常。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dennis@my-remote-server:/var/www/html$ mysqladmin -p -u root version
Enter password:
mysqladmin  Ver 8.42 Distrib 5.7.13, for Linux on x86_64
Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.
Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.
Server version		5.7.13-0ubuntu0.16.04.2
Protocol version	10
Connection		Localhost via UNIX socket
UNIX socket		/var/run/mysqld/mysqld.sock
Uptime:			19 min 14 sec
Threads: 1  Questions: 8  Slow queries: 0  Opens: 115  Flush tables: 1  Open tables: 34  Queries per second avg: 0.006
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;创建数据库及新的数据库用户&quot;&gt;创建数据库及新的数据库用户&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql -u root -p
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;用密码登录成功之后执行下面的sql语句创建一个数据库，名叫lawootrip&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CREATE DATABASE lawootrip DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;安全起见，我们为这个数据库创建一个单独的用户：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;GRANT ALL ON wordpress.* TO 'lawootripuser'@'localhost' IDENTIFIED BY 'password';
FLUSH PRIVILEGES;
EXIT;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;在外网通过IP直接访问操作数据库&lt;/p&gt;

&lt;p&gt;默认情况下,我们只能在服务器上通过localhost访问MySQL,如果需要通过IP从外网访问,需要进行相应的设置。&lt;/p&gt;

&lt;p&gt;1) 修改授权&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;GRANT ALL ON lawootrip.* TO 'lawootripuser'@'%' IDENTIFIED BY 'password';
FLUSH PRIVILEGES;
EXIT;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;如果需要,还可以指定特定的IP地址(替换上面的%即可)。&lt;/p&gt;

&lt;p&gt;或者可以直接修改表:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql -u root -p
mysql&amp;gt; use mysql;
mysql&amp;gt; update user set host = '%' where user = 'root';
mysql&amp;gt; select user, host from user;
+------------------+-----------+
| user             | host      |
+------------------+-----------+
| mysql.sys        | localhost |
| root             | localhost |
| wordpressuser    | %         |
+------------------+-----------+
3 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;2) 修改配置文件&lt;/p&gt;

&lt;p&gt;配置文件位置为/etc/mysql/mysql.conf.d/mysqld.cnf,注释掉其中一行:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bind-address  =127.0.0.1
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;重启MySQL即可:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo service mysql restart
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;配置nginx&quot;&gt;配置Nginx&lt;/h5&gt;

&lt;p&gt;打开配置文件：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo vim /etc/nginx/sites-available/default
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;作如下修改（具体可以参考&lt;a href=&quot;https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-with-lemp-on-ubuntu-16-04&quot;&gt;这里的说明&lt;/a&gt;）&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server {
    . . .
    location = /favicon.ico { log_not_found off; access_log off; }
    location = /robots.txt { log_not_found off; access_log off; allow all; }
    location ~* \.(css|gif|ico|jpeg|jpg|js|png)$ {
        expires max;
        log_not_found off;
    }
    . . .
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;对try_files做如下修改：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server {
    . . .
    location / {
        #try_files $uri $uri/ =404;
        try_files $uri $uri/ /index.php$is_args$args;
    }
    . . .
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;然后检查配置文件的正确性，并重启Nginx：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo nginx -t
//If no errors were reported, reload Nginx by typing:
sudo systemctl reload nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p id=&quot;3&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;四配置多个站点&quot;&gt;四、配置多个站点&lt;/h3&gt;

&lt;p&gt;通常情况下我们需要在Web服务器上部署多个站点,使用多个不同的域名。&lt;/p&gt;

&lt;h4 id=&quot;设置新的文档目录&quot;&gt;设置新的文档目录&lt;/h4&gt;

&lt;p&gt;默认情况下,在Ubuntu上的Nginx已经默认创建了一个server block,其文档目录为/var/www/html(我们在上面安装wordpress的时候使用的就是这个默认的server block)。&lt;/p&gt;

&lt;p&gt;如果我们需要部署多个站点,那么就需要创建多个不同的server block。假如我们需要部署两个网站:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;lawootrip.com
lawoo.cn
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;这样我们就需要设置两个新的文档目录。为统一起见,我们使用xxx.com/html这种目录结构形式:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mkdir -p /var/www/lawootrip.com/html
sudo mkdir -p /var/www/lawoo.cn/html
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;修改一下这两个文档目录的权限:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo chown -R $USER:$USER /var/www/lawootrip.com/html
sudo chown -R $USER:$USER /var/www/lawoo.cn/html
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;这里用到了环境变量&lt;code class=&quot;highlighter-rouge&quot;&gt;$USER&lt;/code&gt;,请确保没有使用root账号进行操作。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dennis@my-remote-server:~$ echo $USER
dennis
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;至此文档目录应该配置好了。如果需要,我们可以通过下面的命令设置一下上层目录的权限:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo chmod -R 755 /var/www
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;需要提醒的是,暂时不需要担心这两个测试域名是否可以访问的问题,后边我们会介绍在本地浏览器如何访问这两个测试域名。&lt;/p&gt;

&lt;h4 id=&quot;为每个站点创建测试文件&quot;&gt;为每个站点创建测试文件&lt;/h4&gt;

&lt;p&gt;创建文件/var/www/lawootrip.com/html/index.html&lt;/p&gt;

&lt;p&gt;创建文件/var/www/lawoo.cn/html/index.html&lt;/p&gt;

&lt;h4 id=&quot;为每个站点创建server-block文件&quot;&gt;为每个站点创建server block文件&lt;/h4&gt;

&lt;p&gt;如前所述,默认情况下Nginx已经配置了一个默认的server block,因此我们可以将默认的server block配置文件拷贝过来稍作修改:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/lawootrip.com
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;打开文件:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo vim /etc/nginx/sites-available/lawootrip.com
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;其内容如下:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server {
        listen 80 default_server;
        listen [::]:80 default_server;
        root /var/www/html;
        index index.html index.htm index.nginx-debian.html;
        server_name _;
        location / {
                try_files $uri $uri/ =404;
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;对其内容稍作修改,修改之后内容如下:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server {
        listen 80;
        listen [::]:80;
        root /var/www/lawootrip.com/html;
        index index.html index.htm index.nginx-debian.html;
        server_name lawootrip.com www.lawootrip.com;
        location / {
                try_files $uri $uri/ =404;
        }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;主要修改了几个地方:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;去掉了default_server字眼。一台服务器上只能有一个default_server的配置,因此我们保留系统最初的设置为默认设置。&lt;/li&gt;
  &lt;li&gt;修改root目录.&lt;/li&gt;
  &lt;li&gt;修改server_name.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;针对第二个站点lawoo.cn也做类似修改。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo cp /etc/nginx/sites-available/lawoo.cn /etc/nginx/sites-available/lawoo.cn
sudo vim /etc/nginx/sites-available/lawoo.cn
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;激活两个站点的server-block&quot;&gt;激活两个站点的server block&lt;/h4&gt;

&lt;p&gt;使用如下命令:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo ln -s /etc/nginx/sites-available/lawootrip.com /etc/nginx/sites-enabled/
sudo ln -s /etc/nginx/sites-available/lawoo.cn /etc/nginx/sites-enabled/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;这样这些文件(链接)就位于激活的目录内了。到目前为止我们有3个激活了的server block了。服务器根据listen指令和server_name来确定该访问那个目录。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;lawootrip.com: 响应来自lawootrip.com以及www.lawootrip.com的请求&lt;/li&gt;
  &lt;li&gt;lawoo.cn: 响应来自lawoo.cn以及www.lawoo.cn的请求&lt;/li&gt;
  &lt;li&gt;default: 响应没有匹配到上面两个规则的80端口的请求。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;然后检查下nginx配置文件的正确性:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo nginx -t
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;**重启一下nginx使修改生效:**&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl restart nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;关于Nginx更多的指令介绍可以参考&lt;a href=&quot;https://www.digitalocean.com/community/tutorials/understanding-nginx-server-and-location-block-selection-algorithms&quot;&gt;这个教程&lt;/a&gt;。&lt;/p&gt;

&lt;h4 id=&quot;配置二级子域名及代理访问&quot;&gt;配置二级子域名及代理访问&lt;/h4&gt;

&lt;p&gt;举例来说，比如我们在我的服务器上有两个web程序，一个是之前的 lawootrip.com，另一个程序是python应用，使用端口5555，需要映射到二级域名 demo.lawootrip.com。我们应该如何设置呢？&lt;/p&gt;

&lt;h5 id=&quot;1添加域名解析&quot;&gt;1）添加域名解析&lt;/h5&gt;

&lt;p&gt;这个步骤不多说了，在域名服务提供商网站添加一条A记录，设置域名demo.lawootrip.com。&lt;/p&gt;

&lt;h5 id=&quot;2修改nginx配置文件&quot;&gt;2）修改Nginx配置文件&lt;/h5&gt;

&lt;p&gt;就是我们上面提到的文件&lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/nginx/sites-available/lawootrip.com&lt;/code&gt;,添加如下内容：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server {
    listen 80;
    server_name demo.example.com;
    location / {
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   Host      $http_host;
        proxy_pass         http://127.0.0.1:5555;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;然后重启Nginx即可。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl restart nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;Tips 阿里云特供&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Ubuntu 在每次执行命令的时候，会报如下错误：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo
sudo: unable to resolve host iZj6cfyvsfiajdiy47qddhZ
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;iZj6cfyvsfiajdiy47qddhZ是阿里云创建服务器默认的hostname，错误其实没有什么影响，但看起来很不爽，解决方式：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ vim /etc/hostname
iZj6cfyvsfiajdiy47qddhZ
$ vim /etc/hosts
127.0.0.1       localhost iZj6cfyvsfiajdiy47qddhZ
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;结尾处增加hostname.搞定.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://foofish.net/https-free-for-lets-encrypt.html&quot;&gt;免费HTTPS证书Let’s Encrypt安装教程&lt;/a&gt;
&lt;a href=&quot;http://tengine.taobao.org/book/chapter_02.html&quot;&gt;nginx平台初探(100%)&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/0%20%2837%29.gif&quot; /&gt; &lt;/td&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/1490924677.png&quot; /&gt;&lt;div&gt;&lt;small class=&quot;img-hint&quot;&gt;这不是收钱的  加个好友而已&lt;/small&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;&lt;a href=&quot;https://linghucong.js.org/2016/08/18/ubuntu_1604_web_server_config_LEMP/&quot;&gt;主要参考教程&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 02 Nov 2017 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2017/11/02/mylinux-virginnight/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/11/02/mylinux-virginnight/</guid>
        
        <category>笔记</category>
        
        <category>服务器</category>
        
        <category>Linux</category>
        
        
      </item>
    
      <item>
        <title>用Charles在iOS上抓包</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;Vue.js 放弃中…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;来总结一下用Charles在iOS上抓包的方法。&lt;/p&gt;

&lt;p&gt;本文分三个部分：&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#0&quot;&gt;一、Mac客户端 下载安装激活&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#1&quot;&gt;二、Mac/iPhone证书 下载安装信任&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#2&quot;&gt;三、抓&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;我是看不见的分割线&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p id=&quot;0&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;一mac客户端-下载安装激活&quot;&gt;一、Mac客户端 下载安装激活&lt;/h2&gt;

&lt;p&gt;首先安装一枚Charles Mac版，俗称花瓶的抓包神器。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.charlesproxy.com/&quot;&gt;官网下载地址&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://image.lawootrip.com/2017-10-17-1.png&quot; alt=&quot;&quot; /&gt;
&lt;small class=&quot;img-hint&quot;&gt;如图所示下载最新版本&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;下载并安装后打开并激活,Charles提供15天的免费试用，购买正价为30$。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;顺便说一句，破解版Charles偶发中文乱码，抓包数据不显示等问题,而且更新也不及时，建议购买正版神器。&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;打开Charles后，点击菜单栏的Proxy-&amp;gt;Proxy Settings…&lt;/p&gt;

&lt;p&gt;勾选：HTTP Proxy，并设置Port为8888。&lt;/p&gt;

&lt;p&gt;如下图：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://image.lawootrip.com/2017-10-17-2.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;http://image.lawootrip.com/2017-10-17-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p id=&quot;1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;二iphone证书-下载安装信任&quot;&gt;二、iPhone证书 下载安装信任&lt;/h2&gt;

&lt;p&gt;安装好Mac客户端，就拿起手机开始配置iPhone了。&lt;/p&gt;

&lt;h3 id=&quot;先用mac建立同iphone的代理通道&quot;&gt;先用Mac建立同iPhone的代理通道&lt;/h3&gt;

&lt;p&gt;打开自己电脑的系统偏好设置-&amp;gt;网络-&amp;gt;选中现在连着的wifi,以查到自己这个电脑在现在这个wifi里的IP地址，比如我现在这个就是192.168.0.115（建议最好用私人或普通开放网络，用公司内网可能会有限制会出现代理失败的问题）&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2155136-404b2e0bea921839.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;然后确保手机也连接了同一个wifi，然后进入手机的wifi配置(wifi名称右边的蓝色“i”图标)，将http代理改为:192.168.0.115；端口：8888。点击左上角返回。返回后系统会自动设置代理重新连接。&lt;/p&gt;

&lt;p&gt;这时候你的手机上网的过程中就要经过你的电脑了。刚用手机打开一个联网的程序，你的电脑上应该会显示一个弹窗问你【allow】还是【deny】肯定不能拒绝啊就点allow吧。这个只有第一次才弹窗。点了同意之后你手机发出的每一个请求都会被拦截出痕迹。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2469183-8630cf0087d20187.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2469183-874a256420dcae1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;注意：开启花瓶代理后，要关闭所有其他形式的代理，如爱国SS、爱国VPN等。&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;再安装ssl证书到手机设备&quot;&gt;再安装SSL证书到手机设备&lt;/h3&gt;

&lt;p&gt;点击 Help -&amp;gt; SSL Proxying -&amp;gt; Install Charles Root Certificate on a Mobile Device&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2469183-8f47a1b1c1540ef7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2469183-c7f6ad4a204b0bd4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;
&lt;small class=&quot;img-hint&quot;&gt;出现弹窗得到地址&lt;a href=&quot;chls.pro/ssl&quot;&gt;chls.pro/ssl&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;在手机Safari浏览器输入地址 chls.pro/ssl，出现证书安装页面，点击安装
手机设置有密码的输入密码进行安装&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2469183-7ed4a5c8c2a36217.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;
&lt;small class=&quot;img-hint&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;注意：安装信任证书需保持电脑对手机的代理状态&lt;/code&gt;&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;iOS 10.3及以上的系统，需要在 设置→通用→关于本机→证书信任设置 里面启用完全信任Charles证书&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://image.lawootrip.com/2017-10-17-4.png&quot; alt=&quot;&quot; /&gt;
&lt;small class=&quot;img-hint&quot;&gt;图示为iOS11界面&lt;/small&gt;&lt;/p&gt;

&lt;h3 id=&quot;最后charles设置proxy&quot;&gt;最后Charles设置Proxy&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2469183-2c460b4652797ccf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;
&lt;small class=&quot;img-hint&quot;&gt;Proxy -&amp;gt; SSL Proxying Settings…&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2469183-11eb2be75eae13fb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;勾选Enable SSL Proxying,点击Add&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Host填写：*&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Port填写：443&lt;/code&gt;&lt;/p&gt;

&lt;p id=&quot;2&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;三抓&quot;&gt;三、抓&lt;/h2&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;大

功

告

成

！
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;让手机重新发送https请求，可看到抓包&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2469183-5f1b21912781d466.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;注意：不抓包请关闭手机HTTP代理，否则断开与电脑连接后会连不上网&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Charles还有不少好玩的网络调试功能，等我放弃Vue了再来说说。&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/0%20%2837%29.gif&quot; /&gt; &lt;/td&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/1490924677.png&quot; /&gt;&lt;div&gt;&lt;small class=&quot;img-hint&quot;&gt;这不是收钱的  加个好友而已&lt;/small&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</description>
        <pubDate>Tue, 17 Oct 2017 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2017/10/17/charles-ssl/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/10/17/charles-ssl/</guid>
        
        <category>笔记</category>
        
        <category>效率</category>
        
        <category>前端</category>
        
        
      </item>
    
      <item>
        <title>Mac下重置MySQL的权限、密码</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;Vue.js 放弃中…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;每次重启Mac后，我的Navicat都会提示本地的MySQL服务密码不对。&lt;/p&gt;

&lt;p&gt;每次都需要用sudo刷新MySQL权限才可以正常连接，即使重置密码，再次重启MySQL服务后，又提示密码不对。&lt;/p&gt;

&lt;p&gt;所以暂时先把命令行强行重置MySQL密码的方法记录如下，日后再研究如何彻底解决。&lt;/p&gt;

&lt;h2 id=&quot;mysql的三个基本命令&quot;&gt;MySQL的三个基本命令&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    sudo /usr/local/mysql/support-files/mysql.server start //启动

    sudo /usr/local/mysql/support-files/mysql.server stop //停止

    sudo /usr/local/mysql/support-files/mysql.server restart //重启

    sudo pkill -9 mysql //强制关闭进程
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;-三步重置mysql权限和密码&quot;&gt;* 三步重置MySQL权限和密码&lt;/h2&gt;

&lt;h4 id=&quot;第一步&quot;&gt;第一步&lt;/h4&gt;

&lt;p&gt;停止 mysql server.  通常是在 ‘系统偏好设置’ &amp;gt; MySQL &amp;gt; ‘Stop MySQL Server’&lt;/p&gt;

&lt;p&gt;也可以在命令行中用上面的命令终止MySQL。&lt;/p&gt;

&lt;h4 id=&quot;第二步&quot;&gt;第二步&lt;/h4&gt;

&lt;p&gt;新开一个终端，输入：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    sudo /usr/local/mysql/bin/mysqld_safe --skip-grant-tables
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;此时MySQl应该又重新启动了。&lt;/p&gt;

&lt;h4 id=&quot;第三步&quot;&gt;第三步&lt;/h4&gt;

&lt;p&gt;再新开一个终端，依次输入并回车：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    sudo /usr/local/mysql/bin/mysql -u root

    UPDATE mysql.user SET authentication_string=PASSWORD('123123') WHERE User='root';

　　 FLUSH PRIVILEGES;

 　　\q
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;重启MySQL即可&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://image.lawootrip.com/WX20170812-125719@2x.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;清爽&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/0%20%2837%29.gif&quot; /&gt; &lt;/td&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/1490924677.png&quot; /&gt;&lt;div&gt;&lt;small class=&quot;img-hint&quot;&gt;这不是收钱的  加个好友而已&lt;/small&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</description>
        <pubDate>Sat, 12 Aug 2017 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2017/08/12/mysql-psw/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/12/mysql-psw/</guid>
        
        <category>笔记</category>
        
        <category>MySQL</category>
        
        <category>数据库</category>
        
        
      </item>
    
      <item>
        <title>Web缓存的一些细碎02</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;Vue.js 放弃中…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Web缓存是指一个Web资源（如html页面，图片，js，数据等）存在于Web服务器和客户端（浏览器）之间的副本。缓存会根据进来的请求保存输出内容的副本；当下一个请求来到的时候，如果是相同的URL，缓存会根据缓存机制决定是直接使用副本响应访问请求，还是向源服务器再次发送请求。比较常见的就是浏览器会缓存访问过网站的网页，当再次访问这个URL地址的时候，如果网页没有更新，就不会再次下载网页，而是直接使用本地缓存的网页。只有当网站明确标识资源已经更新，浏览器才会再次下载网页。&lt;/p&gt;

&lt;p&gt;本次从三个方面对学习进行小结。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#0&quot;&gt;一、H5缓存机制介绍&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#1&quot;&gt;二、H5缓存机制原理分析&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#2&quot;&gt;三、移动端Web加载性能（缓存）优化&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;我是看不见的分割线&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p id=&quot;0&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;一web缓存的作用&quot;&gt;一、web缓存的作用&lt;/h2&gt;

&lt;p&gt;H5，即 HTML5，是新一代的 HTML 标准，加入很多新的特性。离线存储（也可称为缓存机制）是其中一个非常重要的特性。H5 引入的离线存储，这意味着 web 应用可进行缓存，并可在没有因特网连接时进行访问。&lt;/p&gt;

&lt;p&gt;H5 应用程序缓存为应用带来三个优势：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;离线浏览，用户可以在无网络时使用产品&lt;/li&gt;
  &lt;li&gt;速度，已缓存的资源加载的更快&lt;/li&gt;
  &lt;li&gt;负载优化，浏览器只从服务器下载更新过或更改过的资源&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;H5目前的6种缓存机制在&lt;a href=&quot;http://www.lawootrip.com/2017/07/17/web-localstorage-Volume01/&quot;&gt;前一篇文章&lt;/a&gt;有提及。&lt;/p&gt;

&lt;p&gt;下面将首先分析各种缓存机制的原理、用法及特点；然后针对 Anroid 移动端 Web 性能加载优化的需求，看如果利用适当缓存机制来提高 Web 的加载性能。&lt;/p&gt;

&lt;hr /&gt;
&lt;p id=&quot;1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;二h5-缓存机制原理&quot;&gt;二、H5 缓存机制原理&lt;/h2&gt;

&lt;h3 id=&quot;21-浏览器缓存机制详解&quot;&gt;2.1 浏览器缓存机制详解&lt;/h3&gt;

&lt;p&gt;浏览器缓存机制是指通过 HTTP 协议头里的 Cache-Control（或 Expires）和 Last-Modified（或 Etag）等字段来控制文件缓存的机制。这应该是 WEB 中最早的缓存机制了，是在 HTTP 协议中实现的，有点不同于 Dom Storage、AppCache 等缓存机制，但本质上是一样的。可以理解为，一个是协议层实现的，一个是应用层实现的。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Cache-Control&lt;/strong&gt; 用于控制文件在本地缓存有效时长。最常见的，比如服务器回包：Cache-Control:max-age=600 表示文件在本地应该缓存，且有效时长是600秒（从发出请求算起）。在接下来600秒内，如果有请求这个资源，浏览器不会发出 HTTP 请求，而是直接使用本地缓存的文件。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Last-Modified&lt;/strong&gt; 是标识文件在服务器上的最新更新时间。下次请求时，如果文件缓存过期，浏览器通过 If-Modified-Since 字段带上这个时间，发送给服务器，由服务器比较时间戳来判断文件是否有修改。如果没有修改，服务器返回304告诉浏览器继续使用缓存；如果有修改，则返回200，同时返回最新的文件。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Cache-Control&lt;/strong&gt; 通常与 Last-Modified 一起使用。一个用于控制缓存有效时间，一个在缓存失效后，向服务查询是否有更新。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Cache-Control&lt;/strong&gt; 还有一个同功能的字段：Expires。Expires 的值一个绝对的时间点，如：Expires: Thu, 10 Nov 2015 08:45:11 GMT，表示在这个时间点之前，缓存都是有效的。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Expires&lt;/strong&gt; 是 HTTP1.0 标准中的字段，Cache-Control 是 HTTP1.1 标准中新加的字段，功能一样，都是控制缓存的有效时间。当这两个字段同时出现时，Cache-Control 是高优化级的。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Etag&lt;/strong&gt; 也是和 Last-Modified 一样，对文件进行标识的字段。不同的是，Etag 的取值是一个对文件进行标识的特征字串。在向服务器查询文件是否有更新时，浏览器通过 If-None-Match 字段把特征字串发送给服务器，由服务器和文件最新特征字串进行匹配，来判断文件是否有更新。没有更新回包304，有更新回包200。Etag 和 Last-Modified 可根据需求使用一个或两个同时使用。两个同时使用时，只要满足基中一个条件，就认为文件没有更新。&lt;/p&gt;

&lt;p&gt;另外有两种特殊的情况：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;手动刷新页面（F5)，浏览器会直接认为缓存已经过期（可能缓存还没有过期），在请求中加上字段：&lt;code class=&quot;highlighter-rouge&quot;&gt;Cache-Control:max-age=0&lt;/code&gt;，发包向服务器查询是否有文件是否有更新。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;强制刷新页面（Ctrl+F5)，浏览器会直接忽略本地的缓存（有缓存也会认为本地没有缓存），在请求中加上字段：&lt;code class=&quot;highlighter-rouge&quot;&gt;Cache-Control:no-cache&lt;/code&gt;（或 &lt;code class=&quot;highlighter-rouge&quot;&gt;Pragma:no-cache&lt;/code&gt;），发包向服务重新拉取文件。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;下面是通过 Google Chrome 浏览器（用其他浏览器+抓包工具也可以）自带的开发者工具，对一个资源文件不同情况请求与回包的截图。&lt;/p&gt;

&lt;p&gt;首次请求：200&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://sfault-image.b0.upaiyun.com/241/923/2419230919-56fdeab9a8ba6_articlex&quot; alt=&quot;200&quot; /&gt;&lt;/p&gt;

&lt;p&gt;缓存有效期内请求：200(from cache)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://sfault-image.b0.upaiyun.com/122/114/1221141305-56fdeaba76fb8_articlex&quot; alt=&quot;200 from cache&quot; /&gt;&lt;/p&gt;

&lt;p&gt;缓存过期后请求：304（Not Modified)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://sfault-image.b0.upaiyun.com/135/686/135686075-56fdeabb2c2bc_articlex&quot; alt=&quot;304 from cache&quot; /&gt;&lt;/p&gt;

&lt;p&gt;一般浏览器会将缓存记录及缓存文件存在本地 Cache 文件夹中。Android 下 App 如果使用 Webview，缓存的文件记录及文件内容会存在当前 app 的 data 目录中。&lt;/p&gt;

&lt;p&gt;分析：Cache-Control 和 Last-Modified 一般用在 Web 的静态资源文件上，如 JS、CSS 和一些图像文件。通过设置资源文件缓存属性，对提高资源文件加载速度，节省流量很有意义，特别是移动网络环境。但问题是：缓存有效时长该如何设置？如果设置太短，就起不到缓存的使用；如果设置的太长，在资源文件有更新时，浏览器如果有缓存，则不能及时取到最新的文件。&lt;/p&gt;

&lt;p&gt;Last-Modified 需要向服务器发起查询请求，才能知道资源文件有没有更新。虽然服务器可能返回304告诉没有更新，但也还有一个请求的过程。对于移动网络，这个请求可能是比较耗时的。有一种说法叫“消灭304”，指的就是优化掉304的请求。&lt;/p&gt;

&lt;p&gt;抓包发现，带 if-Modified-Since 字段的请求，如果服务器回包304，回包带有 Cache-Control:max-age 或 Expires 字段，文件的缓存有效时间会更新，就是文件的缓存会重新有效。304回包后如果再请求，则又直接使用缓存文件了，不再向服务器查询文件是否更新了，除非新的缓存时间再次过期。&lt;/p&gt;

&lt;p&gt;另外，Cache-Control 与 Last-Modified 是浏览器内核的机制，一般都是标准的实现，不能更改或设置。以 QQ 浏览器的 X5为例，Cache-Control 与 Last-Modified 缓存不能禁用。缓存容量是12MB，不分HOST，过期的缓存会最先被清除。如果都没过期，应该优先清最早的缓存或最快到期的或文件大小最大的；过期缓存也有可能还是有效的，清除缓存会导致资源文件的重新拉取。&lt;/p&gt;

&lt;p&gt;还有，浏览器，如 X5，在使用缓存文件时，是没有对缓存文件内容进行校验的，这样缓存文件内容被修改的可能。&lt;/p&gt;

&lt;p&gt;分析发现，浏览器的缓存机制还不是非常完美的缓存机制。完美的缓存机制应该是这样的：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;缓存文件没更新，尽可能使用缓存，不用和服务器交互；&lt;/li&gt;
  &lt;li&gt;缓存文件有更新时，第一时间能使用到新的文件；&lt;/li&gt;
  &lt;li&gt;缓存的文件要保持完整性，不使用被修改过的缓存文件；&lt;/li&gt;
  &lt;li&gt;缓存的容量大小要能设置或控制，缓存文件不能因为存储空间限制或过期被清除。以X5为例，第1、2条不能同时满足，第3、4条都不能满足。&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;在实际应用中，为了解决 Cache-Control 缓存时长不好设置的问题，以及为了”消灭304“，Web前端采用的方式是：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;在要缓存的资源文件名中加上版本号或文件 MD5值字串，如 common.d5d02a02.js，common.v1.js，同时设置 Cache-Control:max-age=31536000，也就是一年。在一年时间内，资源文件如果本地有缓存，就会使用缓存；也就不会有304的回包。&lt;/li&gt;
  &lt;li&gt;如果资源文件有修改，则更新文件内容，同时修改资源文件名，如 common.v2.js，html页面也会引用新的资源文件名。&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;通过这种方式，实现了：缓存文件没有更新，则使用缓存；缓存文件有更新，则第一时间使用最新文件的目的。即上面说的第1、2条。第3、4条由于浏览器内部机制，目前还无法满足。&lt;/p&gt;

&lt;h3 id=&quot;22-dom-storage-存储机制&quot;&gt;2.2 Dom Storage 存储机制&lt;/h3&gt;

&lt;p&gt;DOM 存储是一套在 Web Applications 1.0 规范中首次引入的与存储相关的特性的总称，现在已经分离出来，单独发展成为独立的 W3C Web 存储规范。 DOM 存储被设计为用来提供一个更大存储量、更安全、更便捷的存储方法，从而可以代替掉将一些不需要让服务器知道的信息存储到 cookies 里的这种传统方法。&lt;/p&gt;

&lt;p&gt;上面一段是对 Dom Storage 存储机制的官方表述。看起来，Dom Storage 机制类似 Cookies，但有一些优势。&lt;/p&gt;

&lt;p&gt;Dom Storage 是通过存储字符串的 Key/Value 对来提供的，并提供 5MB （不同浏览器可能不同，分 HOST)的存储空间（Cookies 才 4KB)。另外 Dom Storage 存储的数据在本地，不像 Cookies，每次请求一次页面，Cookies 都会发送给服务器。&lt;/p&gt;

&lt;p&gt;DOM Storage 分为 sessionStorage 和 localStorage。localStorage 对象和 sessionStorage 对象使用方法基本相同，它们的区别在于作用的范围不同。sessionStorage 用来存储与页面相关的数据，它在页面关闭后无法使用。而 localStorage 则持久存在，在页面关闭后也可以使用。&lt;/p&gt;

&lt;p&gt;Dom Storage 提供了以下的存储接口：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;interface Storage { 
readonly attribute unsigned long length; 
[IndexGetter] DOMString key(in unsigned long index); 
[NameGetter] DOMString getItem(in DOMString key); 
[NameSetter] void setItem(in DOMString key, in DOMString data); 
[NameDeleter] void removeItem(in DOMString key); 
void clear();
};
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;sessionStorage 是个全局对象，它维护着在页面会话(page session)期间有效的存储空间。只要浏览器开着，页面会话周期就会一直持续。当页面重新载入(reload)或者被恢复(restores)时，页面会话也是一直存在的。每在新标签或者新窗口中打开一个新页面，都会初始化一个新的会话。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;script type=&quot;text/javascript&quot;&amp;gt;
// 当页面刷新时，从sessionStorage恢复之前输入的内容
window.onload = function(){
  if (window.sessionStorage) {
      var name = window.sessionStorage.getItem(&quot;name&quot;);
      if (name != &quot;&quot; || name != null){
          document.getElementById(&quot;name&quot;).value = name;
      }
  }
};

// 将数据保存到sessionStorage对象中
function saveToStorage() {
  if (window.sessionStorage) {
     var name = document.getElementById(&quot;name&quot;).value;
     window.sessionStorage.setItem(&quot;name&quot;, name);
     window.location.href=&quot;session_storage.html&quot;;
 }
}
 &amp;lt;/script&amp;gt;

&amp;lt;form action=&quot;./session_storage.html&quot;&amp;gt;
  &amp;lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot;/&amp;gt;
  &amp;lt;input type=&quot;button&quot; value=&quot;Save&quot; onclick=&quot;saveToStorage()&quot;/&amp;gt;
&amp;lt;/form&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;当浏览器被意外刷新的时候，一些临时数据应当被保存和恢复。sessionStorage 对象在处理这种情况的时候是最有用的。比如恢复我们在表单中已经填写的数据。&lt;/p&gt;

&lt;p&gt;把上面的代码复制到 session_storage.html（也可以从附件中直接下载）页面中，用 Google Chrome 浏览器的不同 PAGE 或 WINDOW 打开，在输入框中分别输入不同的文字，再点击“Save”，然后分别刷新。每个 PAGE 或 WINDOW 显示都是当前PAGE输入的内容，互不影响。关闭 PAGE，再重新打开，上一次输入保存的内容已经没有了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://sfault-image.b0.upaiyun.com/220/256/2202563205-56fe424093728_articlex&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://sfault-image.b0.upaiyun.com/935/566/93556648-56fe423f1827f_articlex&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Local Storage 的接口、用法与 Session Storage 一样，唯一不同的是：Local Storage 保存的数据是持久性的。当前 PAGE 关闭（Page Session 结束后），保存的数据依然存在。重新打开PAGE，上次保存的数据可以获取到。另外，Local Storage 是全局性的，同时打开两个 PAGE 会共享一份存数据，在一个PAGE中修改数据，另一个 PAGE 中是可以感知到的。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;script&amp;gt;
  //通过localStorage直接引用key, 另一种写法，等价于：
  //localStorage.getItem(&quot;pageLoadCount&quot;);
  //localStorage.setItem(&quot;pageLoadCount&quot;, value);
  if (!localStorage.pageLoadCount)
localStorage.pageLoadCount = 0;
     localStorage.pageLoadCount = parseInt(localStorage.pageLoadCount) + 1;
     document.getElementById('count').textContent = localStorage.pageLoadCount;
&amp;lt;/script&amp;gt;

&amp;lt;p&amp;gt;
    You have viewed this page
    &amp;lt;span id=&quot;count&quot;&amp;gt;an untold number of&amp;lt;/span&amp;gt;
    time(s).
&amp;lt;/p&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;将上面代码复制到 local_storage.html 的页面中，用浏览器打开，pageLoadCount 的值是1；关闭 PAGE 重新打开，pageLoadCount 的值是2。这是因为第一次的值已经保存了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://sfault-image.b0.upaiyun.com/202/620/2026209678-56fe4241451ef_articlex&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;https://sfault-image.b0.upaiyun.com/836/137/836137524-56fe424228af7_articlex&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;用两个 PAGE 同时打开 local_storage.html，并分别交替刷新，发现两个 PAGE 是共享一个 pageLoadCount 的。&lt;/p&gt;

&lt;p&gt;分析：Dom Storage 给 Web 提供了一种更录活的数据存储方式，存储空间更大（相对 Cookies)，用法也比较简单，方便存储服务器或本地的一些临时数据。&lt;/p&gt;

&lt;p&gt;从 DomStorage 提供的接口来看，DomStorage 适合存储比较简单的数据，如果要存储结构化的数据，可能要借助 JASON了，将要存储的对象转为 JASON 字串。不太适合存储比较复杂或存储空间要求比较大的数据，也不适合存储静态的文件等。&lt;/p&gt;

&lt;h4 id=&quot;23-web-sql-database存储机制&quot;&gt;2.3 Web SQL Database存储机制&lt;/h4&gt;

&lt;p&gt;H5 也提供基于 SQL 的数据库存储机制，用于存储适合数据库的结构化数据。根据官方的标准文档，Web SQL Database 存储机制不再推荐使用，将来也不再维护，而是推荐使用 AppCache 和 IndexedDB。&lt;/p&gt;

&lt;p&gt;现在主流的浏览器（点击查看浏览器支持情况）都还是支持 Web SQL Database 存储机制的。Web SQL Database 存储机制提供了一组 API 供 Web App 创建、存储、查询数据库。&lt;/p&gt;

&lt;p&gt;下面通过简单的例子，演示下 Web SQL Database 的使用。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;script&amp;gt;
    if(window.openDatabase){
      //打开数据库，如果没有则创建
      var db = openDatabase('mydb', '1.0', 'Test DB', 2 * 1024);

       //通过事务，创建一个表，并添加两条记录
      db.transaction(function (tx) {
           tx.executeSql('CREATE TABLE IF NOT EXISTS LOGS (id unique, log)');
           tx.executeSql('INSERT INTO LOGS (id, log) VALUES (1, &quot;foobar&quot;)');
           tx.executeSql('INSERT INTO LOGS (id, log) VALUES (2, &quot;logmsg&quot;)');
       });

      //查询表中所有记录，并展示出来
     db.transaction(function (tx) {
         tx.executeSql('SELECT * FROM LOGS', [], function (tx, results) {
             var len = results.rows.length, i;
             msg = &quot;&amp;lt;p&amp;gt;Found rows: &quot; + len + &quot;&amp;lt;/p&amp;gt;&quot;;
             for(i=0; i&amp;lt;len; i++){
                 msg += &quot;&amp;lt;p&amp;gt;&quot; + results.rows.item(i).log + &quot;&amp;lt;/p&amp;gt;&quot;;
             }
             document.querySelector('#status').innerHTML =  msg;
             }, null);
      });
}

&amp;lt;/script&amp;gt;

&amp;lt;div id=&quot;status&quot; name=&quot;status&quot;&amp;gt;Status Message&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;将上面代码复制到 sql_database.html 中，用浏览器打开，可看到下面的内容。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://sfault-image.b0.upaiyun.com/204/236/2042368915-56fe438fbfd26_articlex&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;官方建议浏览器在实现时，对每个 HOST 的数据库存储空间作一定限制，建议默认是 5MB（分 HOST）的配额；达到上限后，可以申请更多存储空间。另外，现在主流浏览器 SQL Database 的实现都是基于 SQLite。&lt;/p&gt;

&lt;p&gt;分析：SQL Database 的主要优势在于能够存储结构复杂的数据，能充分利用数据库的优势，可方便对数据进行增加、删除、修改、查询。由于 SQL 语法的复杂性，使用起来麻烦一些。SQL Database 也不太适合做静态文件的缓存。&lt;/p&gt;

&lt;hr /&gt;
&lt;p id=&quot;2&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;三移动端-web-加载性能缓存优化&quot;&gt;三、移动端 Web 加载性能（缓存）优化&lt;/h2&gt;

&lt;p&gt;分析完 H5提供的各种缓存机制，回到移动端（针对 Android，可能也适用于 iOS）的场景。现在 Android App大多嵌入了 Webview 的组件（系统 Webview 或 QQ 游览器的 X5组件），通过内嵌Webview 来加载一些H5的运营活动页面或资讯页。这样可充分发挥Web前端的优势：快速开发、发布，灵活上下线。但 Webview 也有一些不可忽视的问题，比较突出的就是加载相对较慢，会相对消耗较多流量。&lt;/p&gt;

&lt;p&gt;通过对一些 H5页面进行调试及抓包发现，每次加载一个 H5页面，都会有较多的请求。除了 HTML 主 URL 自身的请求外，HTML外部引用的 JS、CSS、字体文件、图片都是一个独立的 HTTP 请求，每一个请求都串行的（可能有连接复用）。这么多请求串起来，再加上浏览器解析、渲染的时间，Web 整体的加载时间变得较长；请求文件越多，消耗的流量也会越多。我们可综合使用上面说到几种缓存机制，来帮助我们优化 Web 的加载性能。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://sfault-image.b0.upaiyun.com/129/554/1295547036-56fe42e54e817_articlex&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;结论：综合各种缓存机制比较，对于静态文件，如 JS、CSS、字体、图片等，适合通过浏览器缓存机制来进行缓存，通过缓存文件可大幅提升 Web 的加载速度，且节省流量。但也有一些不足：缓存文件需要首次加载后才会产生；浏览器缓存的存储空间有限，缓存有被清除的可能；缓存的文件没有校验。要解决这些不足，可以参考手 Q 的离线包，它有效的解决了这些不足。&lt;/p&gt;

&lt;p&gt;对于 Web 在本地或服务器获取的数据，可以通过 Dom Storage 和 IndexedDB 进行缓存。也在一定程度上减少和 Server 的交互，提高加载速度，同时节省流量。&lt;/p&gt;

&lt;p&gt;当然 Web 的性能优化，还包括选择合适的图片大小，避免 JS 和 CSS 造成的阻塞等。这就需要 Web 前端的同事根据一些规范和一些调试工具进行优化了。&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;br /&gt; 
&lt;br /&gt;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/0%20%2837%29.gif&quot; /&gt; &lt;/td&gt;
&lt;td&gt;
&lt;img src=&quot;http://image.lawootrip.com/1490924677.png&quot; /&gt;&lt;div&gt;&lt;small class=&quot;img-hint&quot;&gt;这不是收钱的  加个好友而已&lt;/small&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</description>
        <pubDate>Tue, 18 Jul 2017 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2017/07/18/web-localstorage-Volume02/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/07/18/web-localstorage-Volume02/</guid>
        
        <category>笔记</category>
        
        <category>Web前端</category>
        
        
      </item>
    
  </channel>
</rss>
